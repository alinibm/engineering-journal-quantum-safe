<!DOCTYPE html><html lang="en" dir="ltr" data-has-toc data-has-sidebar data-theme="dark" class="astro-bguv2lll"> <head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>EKS Cluster build | IBM Quantum Safe</title><link rel="canonical" href="https://ibm-client-engineering.github.io/engineering-journal-quantum-safe/guardium_insights/02_cluster-build/"/><link rel="sitemap" href="/engineering-journal-quantum-safe/sitemap-index.xml"/><link rel="shortcut icon" href="/engineering-journal-quantum-safe/favicon.svg" type="image/svg+xml"/><meta name="generator" content="Astro v4.16.6"/><meta name="generator" content="Starlight v0.24.5"/><meta property="og:title" content="EKS Cluster build"/><meta property="og:type" content="article"/><meta property="og:url" content="https://ibm-client-engineering.github.io/engineering-journal-quantum-safe/guardium_insights/02_cluster-build/"/><meta property="og:locale" content="en"/><meta property="og:description" content="Running Guardium Insights with QSPM on EKS"/><meta property="og:site_name" content="IBM Quantum Safe"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="EKS Cluster build"/><meta name="twitter:description" content="Running Guardium Insights with QSPM on EKS"/><meta name="description" content="Running Guardium Insights with QSPM on EKS"/><script>
	window.StarlightThemeProvider = (() => {
		const storedTheme =
			typeof localStorage !== 'undefined' && localStorage.getItem('starlight-theme');
		const theme =
			storedTheme ||
			(window.matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'dark');
		document.documentElement.dataset.theme = theme === 'light' ? 'light' : 'dark';
		return {
			updatePickers(theme = storedTheme || 'auto') {
				document.querySelectorAll('starlight-theme-select').forEach((picker) => {
					const select = picker.querySelector('select');
					if (select) select.value = theme;
					/** @type {HTMLTemplateElement | null} */
					const tmpl = document.querySelector(`#theme-icons`);
					const newIcon = tmpl && tmpl.content.querySelector('.' + theme);
					if (newIcon) {
						const oldIcon = picker.querySelector('svg.label-icon');
						if (oldIcon) {
							oldIcon.replaceChildren(...newIcon.cloneNode(true).childNodes);
						}
					}
				});
			},
		};
	})();
</script><template id="theme-icons"><svg aria-hidden="true" class="light astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M5 12a1 1 0 0 0-1-1H3a1 1 0 0 0 0 2h1a1 1 0 0 0 1-1Zm.64 5-.71.71a1 1 0 0 0 0 1.41 1 1 0 0 0 1.41 0l.71-.71A1 1 0 0 0 5.64 17ZM12 5a1 1 0 0 0 1-1V3a1 1 0 0 0-2 0v1a1 1 0 0 0 1 1Zm5.66 2.34a1 1 0 0 0 .7-.29l.71-.71a1 1 0 1 0-1.41-1.41l-.66.71a1 1 0 0 0 0 1.41 1 1 0 0 0 .66.29Zm-12-.29a1 1 0 0 0 1.41 0 1 1 0 0 0 0-1.41l-.71-.71a1.004 1.004 0 1 0-1.43 1.41l.73.71ZM21 11h-1a1 1 0 0 0 0 2h1a1 1 0 0 0 0-2Zm-2.64 6A1 1 0 0 0 17 18.36l.71.71a1 1 0 0 0 1.41 0 1 1 0 0 0 0-1.41l-.76-.66ZM12 6.5a5.5 5.5 0 1 0 5.5 5.5A5.51 5.51 0 0 0 12 6.5Zm0 9a3.5 3.5 0 1 1 0-7 3.5 3.5 0 0 1 0 7Zm0 3.5a1 1 0 0 0-1 1v1a1 1 0 0 0 2 0v-1a1 1 0 0 0-1-1Z"/></svg> <svg aria-hidden="true" class="dark astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.64 13a1 1 0 0 0-1.05-.14 8.049 8.049 0 0 1-3.37.73 8.15 8.15 0 0 1-8.14-8.1 8.59 8.59 0 0 1 .25-2A1 1 0 0 0 8 2.36a10.14 10.14 0 1 0 14 11.69 1 1 0 0 0-.36-1.05Zm-9.5 6.69A8.14 8.14 0 0 1 7.08 5.22v.27a10.15 10.15 0 0 0 10.14 10.14 9.784 9.784 0 0 0 2.1-.22 8.11 8.11 0 0 1-7.18 4.32v-.04Z"/></svg> <svg aria-hidden="true" class="auto astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"/></svg> </template><link rel="stylesheet" href="/engineering-journal-quantum-safe/css/index.C6j0V8Bn.css">
<style>:root{--sl-badge-default-border: var(--sl-color-accent);--sl-badge-default-bg: var(--sl-color-accent-low);--sl-badge-default-text: #fff;--sl-badge-note-border: var(--sl-color-blue);--sl-badge-note-bg: var(--sl-color-blue-low);--sl-badge-note-text: #fff;--sl-badge-danger-border: var(--sl-color-red);--sl-badge-danger-bg: var(--sl-color-red-low);--sl-badge-danger-text: #fff;--sl-badge-success-border: var(--sl-color-green);--sl-badge-success-bg: var(--sl-color-green-low);--sl-badge-success-text: #fff;--sl-badge-caution-border: var(--sl-color-orange);--sl-badge-caution-bg: var(--sl-color-orange-low);--sl-badge-caution-text: #fff;--sl-badge-tip-border: var(--sl-color-purple);--sl-badge-tip-bg: var(--sl-color-purple-low);--sl-badge-tip-text: #fff}[data-theme=light]:root{--sl-badge-default-bg: var(--sl-color-accent-high);--sl-badge-note-bg: var(--sl-color-blue-high);--sl-badge-danger-bg: var(--sl-color-red-high);--sl-badge-success-bg: var(--sl-color-green-high);--sl-badge-caution-bg: var(--sl-color-orange-high);--sl-badge-tip-bg: var(--sl-color-purple-high)}.sl-badge:where(.astro-avdet4wd){display:inline-block;border:1px solid var(--sl-color-border-badge);border-radius:.25rem;font-family:var(--sl-font-system-mono);line-height:normal;color:var(--sl-color-text-badge);background-color:var(--sl-color-bg-badge);overflow-wrap:anywhere}.sidebar-content .sl-badge:where(.astro-avdet4wd){line-height:1;font-size:var(--sl-text-xs);padding:.125rem .375rem}.sidebar-content a[aria-current=page]>.sl-badge:where(.astro-avdet4wd){--sl-color-bg-badge: transparent;--sl-color-border-badge: currentColor;color:inherit}.default:where(.astro-avdet4wd){--sl-color-bg-badge: var(--sl-badge-default-bg);--sl-color-border-badge: var(--sl-badge-default-border);--sl-color-text-badge: var(--sl-badge-default-text)}.note:where(.astro-avdet4wd){--sl-color-bg-badge: var(--sl-badge-note-bg);--sl-color-border-badge: var(--sl-badge-note-border);--sl-color-text-badge: var(--sl-badge-note-text)}.danger:where(.astro-avdet4wd){--sl-color-bg-badge: var(--sl-badge-danger-bg);--sl-color-border-badge: var(--sl-badge-danger-border);--sl-color-text-badge: var(--sl-badge-danger-text)}.success:where(.astro-avdet4wd){--sl-color-bg-badge: var(--sl-badge-success-bg);--sl-color-border-badge: var(--sl-badge-success-border);--sl-color-text-badge: var(--sl-badge-success-text)}.tip:where(.astro-avdet4wd){--sl-color-bg-badge: var(--sl-badge-tip-bg);--sl-color-border-badge: var(--sl-badge-tip-border);--sl-color-text-badge: var(--sl-badge-tip-text)}.caution:where(.astro-avdet4wd){--sl-color-bg-badge: var(--sl-badge-caution-bg);--sl-color-border-badge: var(--sl-badge-caution-border);--sl-color-text-badge: var(--sl-badge-caution-text)}.small:where(.astro-avdet4wd){font-size:var(--sl-text-xs);padding:.125rem .25rem}.medium:where(.astro-avdet4wd){font-size:var(--sl-text-sm);padding:.175rem .35rem}.large:where(.astro-avdet4wd){font-size:var(--sl-text-base);padding:.225rem .45rem}.sl-markdown-content :is(h1,h2,h3,h4,h5,h6) .sl-badge:where(.astro-avdet4wd){vertical-align:middle}
.card-grid:where(.astro-zntqmydn){display:grid;gap:1rem}.card-grid:where(.astro-zntqmydn)>*{margin-top:0!important}@media (min-width: 50rem){.card-grid:where(.astro-zntqmydn){grid-template-columns:1fr 1fr;gap:1.5rem}.stagger:where(.astro-zntqmydn){--stagger-height: 5rem;padding-bottom:var(--stagger-height)}.stagger:where(.astro-zntqmydn)>*:nth-child(2n){transform:translateY(var(--stagger-height))}}
svg:where(.astro-c6vsoqas){color:var(--sl-icon-color);font-size:var(--sl-icon-size, 1em);width:1em;height:1em}
starlight-tabs:where(.astro-esqgolmp){display:block}.tablist-wrapper:where(.astro-esqgolmp){overflow-x:auto}:where(.astro-esqgolmp)[role=tablist]{display:flex;list-style:none;border-bottom:2px solid var(--sl-color-gray-5);padding:0}.tab:where(.astro-esqgolmp){margin-bottom:-2px}.tab:where(.astro-esqgolmp)>:where(.astro-esqgolmp)[role=tab]{display:flex;align-items:center;gap:.5rem;padding:0 1.25rem;text-decoration:none;border-bottom:2px solid var(--sl-color-gray-5);color:var(--sl-color-gray-3);outline-offset:var(--sl-outline-offset-inside);overflow-wrap:initial}.tab:where(.astro-esqgolmp) :where(.astro-esqgolmp)[role=tab][aria-selected=true]{color:var(--sl-color-white);border-color:var(--sl-color-text-accent);font-weight:600}.tablist-wrapper:where(.astro-esqgolmp)~[role=tabpanel]{margin-top:1rem}
.sl-link-card:where(.astro-mf7fz2mj){display:grid;grid-template-columns:1fr auto;gap:.5rem;border:1px solid var(--sl-color-gray-5);border-radius:.5rem;padding:1rem;box-shadow:var(--sl-shadow-sm);position:relative}a:where(.astro-mf7fz2mj){text-decoration:none;line-height:var(--sl-line-height-headings)}a:where(.astro-mf7fz2mj):before{content:"";position:absolute;inset:0}.stack:where(.astro-mf7fz2mj){flex-direction:column;gap:.5rem}.title:where(.astro-mf7fz2mj){color:var(--sl-color-white);font-weight:600;font-size:var(--sl-text-lg)}.description:where(.astro-mf7fz2mj){color:var(--sl-color-gray-3);line-height:1.5}.icon:where(.astro-mf7fz2mj){color:var(--sl-color-gray-3)}.sl-link-card:where(.astro-mf7fz2mj):hover{background:var(--sl-color-gray-7, var(--sl-color-gray-6));border-color:var(--sl-color-gray-2)}.sl-link-card:where(.astro-mf7fz2mj):hover .icon:where(.astro-mf7fz2mj){color:var(--sl-color-white)}
.sl-steps{--bullet-size: calc(var(--sl-line-height) * 1rem);--bullet-margin: .375rem;list-style:none;counter-reset:steps-counter var(--sl-steps-start, 0);padding-inline-start:0}.sl-steps>li{counter-increment:steps-counter;position:relative;padding-inline-start:calc(var(--bullet-size) + 1rem);padding-bottom:1px;min-height:calc(var(--bullet-size) + var(--bullet-margin))}.sl-steps>li+li{margin-top:0}.sl-steps>li:before{content:counter(steps-counter);position:absolute;top:0;inset-inline-start:0;width:var(--bullet-size);height:var(--bullet-size);line-height:var(--bullet-size);font-size:var(--sl-text-xs);font-weight:600;text-align:center;color:var(--sl-color-white);background-color:var(--sl-color-gray-6);border-radius:99rem;box-shadow:inset 0 0 0 1px var(--sl-color-gray-5)}.sl-steps>li:not(:last-of-type):after{--guide-width: 1px;content:"";position:absolute;top:calc(var(--bullet-size) + var(--bullet-margin));bottom:var(--bullet-margin);inset-inline-start:calc((var(--bullet-size) - var(--guide-width)) / 2);width:var(--guide-width);background-color:var(--sl-color-hairline-light)}.sl-steps>li>:first-child{--lh: calc(1em * var(--sl-line-height));--shift-y: calc(.5 * (var(--bullet-size) - var(--lh)));transform:translateY(var(--shift-y));margin-bottom:var(--shift-y)}.sl-steps>li>:first-child:where(h1,h2,h3,h4,h5,h6){--lh: calc(1em * var(--sl-line-height-headings))}@supports (--prop: 1lh){.sl-steps>li>:first-child{--lh: 1lh}}
</style><script type="module" src="/engineering-journal-quantum-safe/css/hoisted.h2JGMvq-.js"></script>
<script type="module" src="/engineering-journal-quantum-safe/css/page.7qqag-5g.js"></script></head> <body class="astro-bguv2lll"> <a href="#_top" class="astro-7q3lir66">Skip to content</a>  <div class="page sl-flex astro-vrdttmbt"> <header class="header astro-vrdttmbt"><div class="header sl-flex astro-kmkmnagf"> <div class="title-wrapper sl-flex astro-kmkmnagf"> <a href="/engineering-journal-quantum-safe/" class="site-title sl-flex astro-m46x6ez3">  <img class="astro-m46x6ez3" alt="" src="/engineering-journal-quantum-safe/css/IBM_logo®_rev_blue50_RGB.CUr4ejvg.png" width="2967" height="1975">  <span class="astro-m46x6ez3"> IBM Quantum Safe </span> </a>  </div> <div class="sl-flex astro-kmkmnagf"> <site-search data-translations="{&#34;placeholder&#34;:&#34;Search&#34;}" class="astro-v37mnknz"> <button data-open-modal disabled class="astro-v37mnknz">  <svg aria-label="Search" class="astro-v37mnknz astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.71 20.29 18 16.61A9 9 0 1 0 16.61 18l3.68 3.68a.999.999 0 0 0 1.42 0 1 1 0 0 0 0-1.39ZM11 18a7 7 0 1 1 0-14 7 7 0 0 1 0 14Z"/></svg>  <span class="sl-hidden md:sl-block astro-v37mnknz" aria-hidden="true">Search</span> <svg aria-label="(Press / to Search)" class="sl-hidden md:sl-block astro-v37mnknz astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M17 2H7a5 5 0 0 0-5 5v10a5 5 0 0 0 5 5h10a5 5 0 0 0 5-5V7a5 5 0 0 0-5-5Zm3 15a3 3 0 0 1-3 3H7a3 3 0 0 1-3-3V7a3 3 0 0 1 3-3h10a3 3 0 0 1 3 3v10Z"/><path d="M15.293 6.707a1 1 0 1 1 1.414 1.414l-8.485 8.486a1 1 0 0 1-1.414-1.415l8.485-8.485Z"/></svg>  </button> <dialog style="padding:0" aria-label="Search" class="astro-v37mnknz"> <div class="dialog-frame sl-flex astro-v37mnknz">  <button data-close-modal class="sl-flex md:sl-hidden astro-v37mnknz"> Cancel </button> <div class="search-container astro-v37mnknz"> <div id="starlight__search" class="astro-v37mnknz"></div> </div> </div> </dialog> </site-search>    </div> <div class="sl-hidden md:sl-flex right-group astro-kmkmnagf"> <div class="sl-flex social-icons astro-kmkmnagf"> <a href="https://github.com/ibm-client-engineering/engineering-journal-quantum-safe" rel="me" class="sl-flex astro-wy4te6ga"><span class="sr-only astro-wy4te6ga">GitHub</span><svg aria-hidden="true" class="astro-wy4te6ga astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"/></svg> </a> </div> <starlight-theme-select>  <label style="--sl-select-width: 6.25em" class="astro-4yphtoen"> <span class="sr-only astro-4yphtoen">Select theme</span> <svg aria-hidden="true" class="icon label-icon astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"/></svg>  <select value="auto" class="astro-4yphtoen"> <option value="dark" class="astro-4yphtoen">Dark</option><option value="light" class="astro-4yphtoen">Light</option><option value="auto" selected class="astro-4yphtoen">Auto</option> </select> <svg aria-hidden="true" class="icon caret astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M17 9.17a1 1 0 0 0-1.41 0L12 12.71 8.46 9.17a1 1 0 1 0-1.41 1.42l4.24 4.24a1.002 1.002 0 0 0 1.42 0L17 10.59a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </label>  </starlight-theme-select>  <script>
	StarlightThemeProvider.updatePickers();
</script>   </div> </div> </header> <nav class="sidebar astro-vrdttmbt" aria-label="Main"> <starlight-menu-button class="astro-jif73yzw"> <button aria-expanded="false" aria-label="Menu" aria-controls="starlight__sidebar" class="sl-flex md:sl-hidden astro-jif73yzw"> <svg aria-hidden="true" class="astro-jif73yzw astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M3 8h18a1 1 0 1 0 0-2H3a1 1 0 0 0 0 2Zm18 8H3a1 1 0 0 0 0 2h18a1 1 0 0 0 0-2Zm0-5H3a1 1 0 0 0 0 2h18a1 1 0 0 0 0-2Z"/></svg>  </button> </starlight-menu-button>    <div id="starlight__sidebar" class="sidebar-pane astro-vrdttmbt"> <div class="sidebar-content sl-flex astro-vrdttmbt"> <ul class="top-level astro-3ii7xxms"> <li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Forward</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/engineering-journal-quantum-safe/how-we-work/fundamentals/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">How We Work</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/engineering-journal-quantum-safe/how-we-work/mission/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Our Mission</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">QSR</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Adaptive Proxy</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/engineering-journal-quantum-safe/qsr/adaptive_proxy/01_installation/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Installation</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/engineering-journal-quantum-safe/qsr/adaptive_proxy/02_configuration/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Configuration</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Performance Test Harness</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/engineering-journal-quantum-safe/qsr/performance_test_harness/01_installation/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Installation</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/engineering-journal-quantum-safe/qsr/performance_test_harness/02_usage/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Usage</span>  </a> </li> </ul>  </details> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">QSE</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/engineering-journal-quantum-safe/qse/01_installation/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Installation</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/engineering-journal-quantum-safe/qse/02_scanning/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Scanning</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Guardium Insights</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/engineering-journal-quantum-safe/guardium_insights/01_pre-reqs/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Pre-Requisites</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/engineering-journal-quantum-safe/guardium_insights/02_cluster-build/" aria-current="page" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Cluster Build</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/engineering-journal-quantum-safe/guardium_insights/03_gi-install/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Guardium Insights Installation</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/engineering-journal-quantum-safe/guardium_insights/04_optional_services/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Optional Services</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Reference</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="https://www.ibm.com/docs/en/quantum-safe/quantum-safe-remediator/1.0.x" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">QSR</span> <span class="sl-badge default small  astro-3ii7xxms astro-avdet4wd">IBM</span>  </a> </li><li class="astro-3ii7xxms"> <a href="https://www.ibm.com/docs/en/quantum-safe/quantum-safe-explorer/1.0.x" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">QSE</span> <span class="sl-badge default small  astro-3ii7xxms astro-avdet4wd">IBM</span>  </a> </li><li class="astro-3ii7xxms"> <a href="https://www.ibm.com/docs/en/guardium-insights/3.x?topic=scenarios-installation-amazon-elastic-kubernetes-service-eks" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Guardium Insights</span> <span class="sl-badge default small  astro-3ii7xxms astro-avdet4wd">IBM</span>  </a> </li> </ul>  </details> </li> </ul>  <div class="md:sl-hidden"> <div class="mobile-preferences sl-flex astro-wu23bvmt"> <div class="sl-flex social-icons astro-wu23bvmt"> <a href="https://github.com/ibm-client-engineering/engineering-journal-quantum-safe" rel="me" class="sl-flex astro-wy4te6ga"><span class="sr-only astro-wy4te6ga">GitHub</span><svg aria-hidden="true" class="astro-wy4te6ga astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"/></svg> </a> </div> <starlight-theme-select>  <label style="--sl-select-width: 6.25em" class="astro-4yphtoen"> <span class="sr-only astro-4yphtoen">Select theme</span> <svg aria-hidden="true" class="icon label-icon astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"/></svg>  <select value="auto" class="astro-4yphtoen"> <option value="dark" class="astro-4yphtoen">Dark</option><option value="light" class="astro-4yphtoen">Light</option><option value="auto" selected class="astro-4yphtoen">Auto</option> </select> <svg aria-hidden="true" class="icon caret astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M17 9.17a1 1 0 0 0-1.41 0L12 12.71 8.46 9.17a1 1 0 1 0-1.41 1.42l4.24 4.24a1.002 1.002 0 0 0 1.42 0L17 10.59a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </label>  </starlight-theme-select>  <script>
	StarlightThemeProvider.updatePickers();
</script>   </div>  </div> </div> </div> </nav> <div class="main-frame astro-vrdttmbt">  <div class="lg:sl-flex astro-67yu43on"> <aside class="right-sidebar-container astro-67yu43on"> <div class="right-sidebar astro-67yu43on"> <div class="lg:sl-hidden astro-pb3aqygn"><mobile-starlight-toc data-min-h="2" data-max-h="3" class="astro-doynk5tl"><nav aria-labelledby="starlight__on-this-page--mobile" class="astro-doynk5tl"><details id="starlight__mobile-toc" class="astro-doynk5tl"><summary id="starlight__on-this-page--mobile" class="sl-flex astro-doynk5tl"><div class="toggle sl-flex astro-doynk5tl">On this page<svg aria-hidden="true" class="caret astro-doynk5tl astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </div><span class="display-current astro-doynk5tl"></span></summary><div class="dropdown astro-doynk5tl"><ul class="isMobile astro-g2bywc46" style="--depth: 0;"> <li class="astro-g2bywc46" style="--depth: 0;"> <a href="#_top" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Overview</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#creating-the-cluster" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Creating the cluster</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#configure-kubectl" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Configure kubectl</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#install-the-ebs-driver-to-the-cluster" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Install the EBS driver to the cluster</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#verifying-ebs" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Verifying EBS</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#enable-efs-on-the-cluster" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Enable EFS on the cluster</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#create-iam-policy" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Create IAM policy</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#create-iam-role" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Create IAM role</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#install-efs-csi-driver" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Install EFS CSI driver</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#create-the-efs-filesystem" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Create the EFS Filesystem</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#create-efs-storage-class" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Create EFS Storage Class</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#verify-efs" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Verify EFS</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#install-nginx-controller" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Install NGINX Controller</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#verify-the-nginx-deployment" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Verify the NGINX deployment</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#install-the-operator-lifecycle-manager" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Install the Operator Lifecycle Manager</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#create-the-required-namespace" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Create the required Namespace</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#install-the-ibm-cert-manager" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Install the IBM Cert Manager</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#configure-dns-resolution-optional" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Configure DNS resolution (Optional)</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#install-foundational-services" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Install Foundational Services</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#verify-foundational-services-are-properly-installed" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Verify Foundational Services are properly installed</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#verify-that-the-operand-requests-have-completed-and-installed" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Verify that the operand requests have completed and installed</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#verify-ingress" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Verify Ingress</span> </a>  </li> </ul>  </li> </ul> </div></details></nav></mobile-starlight-toc></div><div class="right-sidebar-panel sl-hidden lg:sl-block astro-pb3aqygn"><div class="sl-container astro-pb3aqygn"><starlight-toc data-min-h="2" data-max-h="3"><nav aria-labelledby="starlight__on-this-page"><h2 id="starlight__on-this-page">On this page</h2><ul class="astro-g2bywc46" style="--depth: 0;"> <li class="astro-g2bywc46" style="--depth: 0;"> <a href="#_top" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Overview</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#creating-the-cluster" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Creating the cluster</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#configure-kubectl" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Configure kubectl</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#install-the-ebs-driver-to-the-cluster" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Install the EBS driver to the cluster</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#verifying-ebs" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Verifying EBS</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#enable-efs-on-the-cluster" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Enable EFS on the cluster</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#create-iam-policy" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Create IAM policy</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#create-iam-role" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Create IAM role</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#install-efs-csi-driver" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Install EFS CSI driver</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#create-the-efs-filesystem" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Create the EFS Filesystem</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#create-efs-storage-class" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Create EFS Storage Class</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#verify-efs" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Verify EFS</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#install-nginx-controller" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Install NGINX Controller</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#verify-the-nginx-deployment" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Verify the NGINX deployment</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#install-the-operator-lifecycle-manager" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Install the Operator Lifecycle Manager</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#create-the-required-namespace" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Create the required Namespace</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#install-the-ibm-cert-manager" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Install the IBM Cert Manager</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#configure-dns-resolution-optional" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Configure DNS resolution (Optional)</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#install-foundational-services" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Install Foundational Services</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#verify-foundational-services-are-properly-installed" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Verify Foundational Services are properly installed</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#verify-that-the-operand-requests-have-completed-and-installed" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Verify that the operand requests have completed and installed</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#verify-ingress" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Verify Ingress</span> </a>  </li> </ul>  </li> </ul> </nav></starlight-toc></div></div> </div> </aside> <div class="main-pane astro-67yu43on">  <main data-pagefind-body lang="en" dir="ltr" class="astro-bguv2lll">    <div class="content-panel astro-7nkwcw3z"> <div class="sl-container astro-7nkwcw3z"> <h1 id="_top" class="astro-j6tvhyss">EKS Cluster build</h1>  </div> </div>  <div class="content-panel astro-7nkwcw3z"> <div class="sl-container astro-7nkwcw3z"> <div class="sl-markdown-content"> <aside aria-label="Useful Links" class="starlight-aside starlight-aside--note"><p class="starlight-aside__title" aria-hidden="true"><svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="starlight-aside__icon"><path d="M12 11C11.7348 11 11.4804 11.1054 11.2929 11.2929C11.1054 11.4804 11 11.7348 11 12V16C11 16.2652 11.1054 16.5196 11.2929 16.7071C11.4804 16.8946 11.7348 17 12 17C12.2652 17 12.5196 16.8946 12.7071 16.7071C12.8946 16.5196 13 16.2652 13 16V12C13 11.7348 12.8946 11.4804 12.7071 11.2929C12.5196 11.1054 12.2652 11 12 11ZM12.38 7.08C12.1365 6.97998 11.8635 6.97998 11.62 7.08C11.4973 7.12759 11.3851 7.19896 11.29 7.29C11.2017 7.3872 11.1306 7.49882 11.08 7.62C11.024 7.73868 10.9966 7.86882 11 8C10.9992 8.13161 11.0245 8.26207 11.0742 8.38391C11.124 8.50574 11.1973 8.61656 11.29 8.71C11.3872 8.79833 11.4988 8.86936 11.62 8.92C11.7715 8.98224 11.936 9.00632 12.099 8.99011C12.2619 8.97391 12.4184 8.91792 12.5547 8.82707C12.691 8.73622 12.8029 8.61328 12.8805 8.46907C12.9582 8.32486 12.9992 8.16378 13 8C12.9963 7.73523 12.8927 7.48163 12.71 7.29C12.6149 7.19896 12.5028 7.12759 12.38 7.08ZM12 2C10.0222 2 8.08879 2.58649 6.4443 3.6853C4.79981 4.78412 3.51809 6.3459 2.76121 8.17317C2.00433 10.0004 1.8063 12.0111 2.19215 13.9509C2.578 15.8907 3.53041 17.6725 4.92894 19.0711C6.32746 20.4696 8.10929 21.422 10.0491 21.8079C11.9889 22.1937 13.9996 21.9957 15.8268 21.2388C17.6541 20.4819 19.2159 19.2002 20.3147 17.5557C21.4135 15.9112 22 13.9778 22 12C22 10.6868 21.7413 9.38642 21.2388 8.17317C20.7363 6.95991 19.9997 5.85752 19.0711 4.92893C18.1425 4.00035 17.0401 3.26375 15.8268 2.7612C14.6136 2.25866 13.3132 2 12 2ZM12 20C10.4178 20 8.87104 19.5308 7.55544 18.6518C6.23985 17.7727 5.21447 16.5233 4.60897 15.0615C4.00347 13.5997 3.84504 11.9911 4.15372 10.4393C4.4624 8.88743 5.22433 7.46197 6.34315 6.34315C7.46197 5.22433 8.88743 4.4624 10.4393 4.15372C11.9911 3.84504 13.5997 4.00346 15.0615 4.60896C16.5233 5.21447 17.7727 6.23984 18.6518 7.55544C19.5308 8.87103 20 10.4177 20 12C20 14.1217 19.1572 16.1566 17.6569 17.6569C16.1566 19.1571 14.1217 20 12 20Z"></path></svg>Useful Links</p><section class="starlight-aside__content"><p>Some of these steps come from this documentation for <a href="https://www.ibm.com/docs/en/guardium-insights/3.x?topic=scenarios-installation-amazon-elastic-kubernetes-service-eks">Guardium Insights on EKS</a></p></section></aside>
<aside aria-label="Note" class="starlight-aside starlight-aside--note"><p class="starlight-aside__title" aria-hidden="true"><svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="starlight-aside__icon"><path d="M12 11C11.7348 11 11.4804 11.1054 11.2929 11.2929C11.1054 11.4804 11 11.7348 11 12V16C11 16.2652 11.1054 16.5196 11.2929 16.7071C11.4804 16.8946 11.7348 17 12 17C12.2652 17 12.5196 16.8946 12.7071 16.7071C12.8946 16.5196 13 16.2652 13 16V12C13 11.7348 12.8946 11.4804 12.7071 11.2929C12.5196 11.1054 12.2652 11 12 11ZM12.38 7.08C12.1365 6.97998 11.8635 6.97998 11.62 7.08C11.4973 7.12759 11.3851 7.19896 11.29 7.29C11.2017 7.3872 11.1306 7.49882 11.08 7.62C11.024 7.73868 10.9966 7.86882 11 8C10.9992 8.13161 11.0245 8.26207 11.0742 8.38391C11.124 8.50574 11.1973 8.61656 11.29 8.71C11.3872 8.79833 11.4988 8.86936 11.62 8.92C11.7715 8.98224 11.936 9.00632 12.099 8.99011C12.2619 8.97391 12.4184 8.91792 12.5547 8.82707C12.691 8.73622 12.8029 8.61328 12.8805 8.46907C12.9582 8.32486 12.9992 8.16378 13 8C12.9963 7.73523 12.8927 7.48163 12.71 7.29C12.6149 7.19896 12.5028 7.12759 12.38 7.08ZM12 2C10.0222 2 8.08879 2.58649 6.4443 3.6853C4.79981 4.78412 3.51809 6.3459 2.76121 8.17317C2.00433 10.0004 1.8063 12.0111 2.19215 13.9509C2.578 15.8907 3.53041 17.6725 4.92894 19.0711C6.32746 20.4696 8.10929 21.422 10.0491 21.8079C11.9889 22.1937 13.9996 21.9957 15.8268 21.2388C17.6541 20.4819 19.2159 19.2002 20.3147 17.5557C21.4135 15.9112 22 13.9778 22 12C22 10.6868 21.7413 9.38642 21.2388 8.17317C20.7363 6.95991 19.9997 5.85752 19.0711 4.92893C18.1425 4.00035 17.0401 3.26375 15.8268 2.7612C14.6136 2.25866 13.3132 2 12 2ZM12 20C10.4178 20 8.87104 19.5308 7.55544 18.6518C6.23985 17.7727 5.21447 16.5233 4.60897 15.0615C4.00347 13.5997 3.84504 11.9911 4.15372 10.4393C4.4624 8.88743 5.22433 7.46197 6.34315 6.34315C7.46197 5.22433 8.88743 4.4624 10.4393 4.15372C11.9911 3.84504 13.5997 4.00346 15.0615 4.60896C16.5233 5.21447 17.7727 6.23984 18.6518 7.55544C19.5308 8.87103 20 10.4177 20 12C20 14.1217 19.1572 16.1566 17.6569 17.6569C16.1566 19.1571 14.1217 20 12 20Z"></path></svg>Note</p><section class="starlight-aside__content"><p>This assumes you have already configured <code dir="auto">eksctl</code> and your aws configuration with your account info.</p><p>This also assumes you will be creating the cluster in the us-east region. This can be set to whatever region you want.</p></section></aside>
<p>Run the <code dir="auto">eksctl</code> command below to create your first cluster and perform the following:</p>
<ul>
<li>Create a 4-node Kubernetes cluster named <code dir="auto">gi-east</code> with node type as <code dir="auto">m6i.4xlarge</code> and region as <code dir="auto">us-east-1</code>.</li>
<li>Control plane is managed by AWS EKS, so sizing for control plane nodes doesn’t apply.</li>
<li>Define a minimum of one node (<code dir="auto">--nodes-min 4</code>) and a maximum of three-node (<code dir="auto">--nodes-max 6</code>) for this node group managed by EKS.</li>
<li>Create a node group with the name <code dir="auto">guardium-workers</code> and select a machine type for the <code dir="auto">guardium-workers</code> node group.</li>
</ul>
<aside aria-label="Multiple AZ support" class="starlight-aside starlight-aside--caution"><p class="starlight-aside__title" aria-hidden="true"><svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="starlight-aside__icon"><path d="M12 16C11.8022 16 11.6089 16.0587 11.4444 16.1686C11.28 16.2784 11.1518 16.4346 11.0761 16.6173C11.0004 16.8001 10.9806 17.0011 11.0192 17.1951C11.0578 17.3891 11.153 17.5673 11.2929 17.7071C11.4327 17.847 11.6109 17.9422 11.8049 17.9808C11.9989 18.0194 12.2 17.9996 12.3827 17.9239C12.5654 17.8482 12.7216 17.72 12.8315 17.5556C12.9413 17.3911 13 17.1978 13 17C13 16.7348 12.8946 16.4805 12.7071 16.2929C12.5196 16.1054 12.2652 16 12 16ZM22.67 17.47L14.62 3.47003C14.3598 3.00354 13.9798 2.61498 13.5192 2.3445C13.0586 2.07401 12.5341 1.9314 12 1.9314C11.4659 1.9314 10.9414 2.07401 10.4808 2.3445C10.0202 2.61498 9.64019 3.00354 9.38 3.47003L1.38 17.47C1.11079 17.924 0.966141 18.441 0.960643 18.9688C0.955144 19.4966 1.089 20.0166 1.34868 20.4761C1.60837 20.9356 1.9847 21.3185 2.43968 21.5861C2.89466 21.8536 3.41218 21.9964 3.94 22H20.06C20.5921 22.0053 21.1159 21.8689 21.5779 21.6049C22.0399 21.341 22.4234 20.9589 22.689 20.4978C22.9546 20.0368 23.0928 19.5134 23.0895 18.9814C23.0862 18.4493 22.9414 17.9277 22.67 17.47ZM20.94 19.47C20.8523 19.626 20.7245 19.7556 20.5697 19.8453C20.4149 19.935 20.2389 19.9815 20.06 19.98H3.94C3.76111 19.9815 3.5851 19.935 3.43032 19.8453C3.27553 19.7556 3.14765 19.626 3.06 19.47C2.97223 19.318 2.92602 19.1456 2.92602 18.97C2.92602 18.7945 2.97223 18.622 3.06 18.47L11.06 4.47003C11.1439 4.30623 11.2714 4.16876 11.4284 4.07277C11.5855 3.97678 11.766 3.92599 11.95 3.92599C12.134 3.92599 12.3145 3.97678 12.4716 4.07277C12.6286 4.16876 12.7561 4.30623 12.84 4.47003L20.89 18.47C20.9892 18.6199 21.0462 18.7937 21.055 18.9732C21.0638 19.1527 21.0241 19.3312 20.94 19.49V19.47ZM12 8.00003C11.7348 8.00003 11.4804 8.10538 11.2929 8.29292C11.1054 8.48046 11 8.73481 11 9.00003V13C11 13.2652 11.1054 13.5196 11.2929 13.7071C11.4804 13.8947 11.7348 14 12 14C12.2652 14 12.5196 13.8947 12.7071 13.7071C12.8946 13.5196 13 13.2652 13 13V9.00003C13 8.73481 12.8946 8.48046 12.7071 8.29292C12.5196 8.10538 12.2652 8.00003 12 8.00003Z"></path></svg>Multiple AZ support</p><section class="starlight-aside__content"><p>As of this writing, GI v3.4.0 does not support multiple availability zones.</p></section></aside>
<h2 id="creating-the-cluster">Creating the cluster</h2>
<p>Let’s set some env vars to make our lives easier.</p>
<aside aria-label="On cluster names" class="starlight-aside starlight-aside--note"><p class="starlight-aside__title" aria-hidden="true"><svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="starlight-aside__icon"><path d="M12 11C11.7348 11 11.4804 11.1054 11.2929 11.2929C11.1054 11.4804 11 11.7348 11 12V16C11 16.2652 11.1054 16.5196 11.2929 16.7071C11.4804 16.8946 11.7348 17 12 17C12.2652 17 12.5196 16.8946 12.7071 16.7071C12.8946 16.5196 13 16.2652 13 16V12C13 11.7348 12.8946 11.4804 12.7071 11.2929C12.5196 11.1054 12.2652 11 12 11ZM12.38 7.08C12.1365 6.97998 11.8635 6.97998 11.62 7.08C11.4973 7.12759 11.3851 7.19896 11.29 7.29C11.2017 7.3872 11.1306 7.49882 11.08 7.62C11.024 7.73868 10.9966 7.86882 11 8C10.9992 8.13161 11.0245 8.26207 11.0742 8.38391C11.124 8.50574 11.1973 8.61656 11.29 8.71C11.3872 8.79833 11.4988 8.86936 11.62 8.92C11.7715 8.98224 11.936 9.00632 12.099 8.99011C12.2619 8.97391 12.4184 8.91792 12.5547 8.82707C12.691 8.73622 12.8029 8.61328 12.8805 8.46907C12.9582 8.32486 12.9992 8.16378 13 8C12.9963 7.73523 12.8927 7.48163 12.71 7.29C12.6149 7.19896 12.5028 7.12759 12.38 7.08ZM12 2C10.0222 2 8.08879 2.58649 6.4443 3.6853C4.79981 4.78412 3.51809 6.3459 2.76121 8.17317C2.00433 10.0004 1.8063 12.0111 2.19215 13.9509C2.578 15.8907 3.53041 17.6725 4.92894 19.0711C6.32746 20.4696 8.10929 21.422 10.0491 21.8079C11.9889 22.1937 13.9996 21.9957 15.8268 21.2388C17.6541 20.4819 19.2159 19.2002 20.3147 17.5557C21.4135 15.9112 22 13.9778 22 12C22 10.6868 21.7413 9.38642 21.2388 8.17317C20.7363 6.95991 19.9997 5.85752 19.0711 4.92893C18.1425 4.00035 17.0401 3.26375 15.8268 2.7612C14.6136 2.25866 13.3132 2 12 2ZM12 20C10.4178 20 8.87104 19.5308 7.55544 18.6518C6.23985 17.7727 5.21447 16.5233 4.60897 15.0615C4.00347 13.5997 3.84504 11.9911 4.15372 10.4393C4.4624 8.88743 5.22433 7.46197 6.34315 6.34315C7.46197 5.22433 8.88743 4.4624 10.4393 4.15372C11.9911 3.84504 13.5997 4.00346 15.0615 4.60896C16.5233 5.21447 17.7727 6.23984 18.6518 7.55544C19.5308 8.87103 20 10.4177 20 12C20 14.1217 19.1572 16.1566 17.6569 17.6569C16.1566 19.1571 14.1217 20 12 20Z"></path></svg>On cluster names</p><section class="starlight-aside__content"><p>We’re deploying in <code dir="auto">us-east-1</code> and we are naming our cluster <code dir="auto">gi-east</code>. This name will be exclusive to this cluster, so <code dir="auto">gi-east</code> is an example here. You aren’t bound to using <code dir="auto">gi-east</code> as your name.</p></section></aside>
<div class="expressive-code"><link rel="stylesheet" href="/engineering-journal-quantum-safe/css/ec.j8ofn.css"><script type="module" src="/engineering-journal-quantum-safe/css/ec.8zarh.js"></script><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">export</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3C63B3">clustername</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#C5E478;--1:#3C63B3">gi-east</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">export</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3C63B3">region</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#C5E478;--1:#3C63B3">us-east-1</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="export clustername=gi-eastexport region=us-east-1"><div></div></button></div></figure></div>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">eksctl create cluster \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">name ${clustername} \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">version </span><span style="--0:#F78C6C;--1:#AA0982">1.31</span><span style="--0:#D6DEEB;--1:#403F53"> \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">region ${region} \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">zones ${region}a,${region}b \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">nodegroup</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">name guardium</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">workers \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">node</span><span style="--0:#C792EA;--1:#8D46B4">-type</span><span style="--0:#D6DEEB;--1:#403F53"> m6i.4xlarge \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">--with-oidc \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">--nodes 4 \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">--nodes-min 4 \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">--nodes-max 6 \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">--node-zones ${region}a \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">tags </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">Product=Guardium</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">managed</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="eksctl create cluster \--name ${clustername} \--version 1.31 \--region ${region} \--zones ${region}a,${region}b \--nodegroup-name guardium-workers \--node-type m6i.4xlarge \--with-oidc \--nodes 4 \--nodes-min 4 \--nodes-max 6 \--node-zones ${region}a \--tags &#x22;Product=Guardium&#x22; \--managed"><div></div></button></div></figure></div>
<p>Associate an IAM oidc provider with the cluster if you didn’t include <code dir="auto">--with-oidc</code> above.</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">eksctl utils associate</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">iam</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">oidc</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">provider </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">region</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53">${region} </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">cluster</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53">${clustername} </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">approve</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="eksctl utils associate-iam-oidc-provider --region=${region} --cluster=${clustername} --approve"><div></div></button></div></figure></div>
<h2 id="configure-kubectl">Configure <code dir="auto">kubectl</code></h2>
<p>Once the cluster is up, add it to your kube config. <code dir="auto">eksctl</code> will probably do this for you.</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">aws eks update</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">kubeconfig </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">name ${clustername} </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">region ${region}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="aws eks update-kubeconfig --name ${clustername} --region ${region}"><div></div></button></div></figure></div>

<aside aria-label="Deploying Optional OPA Security Constraints" class="starlight-aside starlight-aside--note"><p class="starlight-aside__title" aria-hidden="true"><svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="starlight-aside__icon"><path d="M12 11C11.7348 11 11.4804 11.1054 11.2929 11.2929C11.1054 11.4804 11 11.7348 11 12V16C11 16.2652 11.1054 16.5196 11.2929 16.7071C11.4804 16.8946 11.7348 17 12 17C12.2652 17 12.5196 16.8946 12.7071 16.7071C12.8946 16.5196 13 16.2652 13 16V12C13 11.7348 12.8946 11.4804 12.7071 11.2929C12.5196 11.1054 12.2652 11 12 11ZM12.38 7.08C12.1365 6.97998 11.8635 6.97998 11.62 7.08C11.4973 7.12759 11.3851 7.19896 11.29 7.29C11.2017 7.3872 11.1306 7.49882 11.08 7.62C11.024 7.73868 10.9966 7.86882 11 8C10.9992 8.13161 11.0245 8.26207 11.0742 8.38391C11.124 8.50574 11.1973 8.61656 11.29 8.71C11.3872 8.79833 11.4988 8.86936 11.62 8.92C11.7715 8.98224 11.936 9.00632 12.099 8.99011C12.2619 8.97391 12.4184 8.91792 12.5547 8.82707C12.691 8.73622 12.8029 8.61328 12.8805 8.46907C12.9582 8.32486 12.9992 8.16378 13 8C12.9963 7.73523 12.8927 7.48163 12.71 7.29C12.6149 7.19896 12.5028 7.12759 12.38 7.08ZM12 2C10.0222 2 8.08879 2.58649 6.4443 3.6853C4.79981 4.78412 3.51809 6.3459 2.76121 8.17317C2.00433 10.0004 1.8063 12.0111 2.19215 13.9509C2.578 15.8907 3.53041 17.6725 4.92894 19.0711C6.32746 20.4696 8.10929 21.422 10.0491 21.8079C11.9889 22.1937 13.9996 21.9957 15.8268 21.2388C17.6541 20.4819 19.2159 19.2002 20.3147 17.5557C21.4135 15.9112 22 13.9778 22 12C22 10.6868 21.7413 9.38642 21.2388 8.17317C20.7363 6.95991 19.9997 5.85752 19.0711 4.92893C18.1425 4.00035 17.0401 3.26375 15.8268 2.7612C14.6136 2.25866 13.3132 2 12 2ZM12 20C10.4178 20 8.87104 19.5308 7.55544 18.6518C6.23985 17.7727 5.21447 16.5233 4.60897 15.0615C4.00347 13.5997 3.84504 11.9911 4.15372 10.4393C4.4624 8.88743 5.22433 7.46197 6.34315 6.34315C7.46197 5.22433 8.88743 4.4624 10.4393 4.15372C11.9911 3.84504 13.5997 4.00346 15.0615 4.60896C16.5233 5.21447 17.7727 6.23984 18.6518 7.55544C19.5308 8.87103 20 10.4177 20 12C20 14.1217 19.1572 16.1566 17.6569 17.6569C16.1566 19.1571 14.1217 20 12 20Z"></path></svg>Deploying Optional OPA Security Constraints</p><section class="starlight-aside__content"><p>If you plan to use the Gatekeeper OPA on your cluster, follow the instructions <a href="../04_optional_services/#configure-security-constraints-optional">here</a></p></section></aside>
<h2 id="install-the-ebs-driver-to-the-cluster">Install the EBS driver to the cluster</h2>
<p>We install the EBS CSI driver as this gives us access to GP3 block storage.</p>
<p>Download the example ebs iam policy</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">curl </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">o iam</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">policy</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">example</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">ebs</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">json</span><span style="--0:#D6DEEB;--1:#403F53"> https:</span><span style="--0:#809191;--1:#5E6578">//raw.githubusercontent.com/kubernetes-sigs/aws-ebs-csi-driver/master/docs/example-iam-policy.json</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="curl -o iam-policy-example-ebs.json https://raw.githubusercontent.com/kubernetes-sigs/aws-ebs-csi-driver/master/docs/example-iam-policy.json"><div></div></button></div></figure></div>
<p>Create the policy. You can change  <code dir="auto">AmazonEKS_EBS_CSI_Driver_Policy</code> to a different name, but if you do, make sure to change it in later steps too.</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">aws iam create</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">policy \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">policy</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">name AmazonEKS_EBS_CSI_Driver_Policy \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">tags </span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">{"Key": "Product","Value": "Guardium"}</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#D6DEEB;--1:#403F53"> \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">policy</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">document file:</span><span style="--0:#809191;--1:#5E6578">//iam-policy-example-ebs.json</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="aws iam create-policy \--policy-name AmazonEKS_EBS_CSI_Driver_Policy \--tags &#x27;{&#x22;Key&#x22;: &#x22;Product&#x22;,&#x22;Value&#x22;: &#x22;Guardium&#x22;}&#x27; \--policy-document file://iam-policy-example-ebs.json"><div></div></button></div></figure></div>
<p>Output should be similar to below</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">Policy</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">: {</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">PolicyName</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">AmazonEKS_EBS_CSI_Driver_Policy</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">PolicyId</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">ANPA24LVTCGN5YOUAVX2V</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">Arn</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">arn:aws:iam::&#x3C;ACCOUNT ID>:policy/AmazonEKS_EBS_CSI_Driver_Policy</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">Path</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">/</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">DefaultVersionId</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">v1</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">AttachmentCount</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">PermissionsBoundaryUsageCount</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">IsAttachable</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#FF5874;--1:#A54A4A">true</span><span style="--0:#D6DEEB;--1:#403F53">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">CreateDate</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">2023-04-19T14:17:03+00:00</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">UpdateDate</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">2023-04-19T14:17:03+00:00</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">Tags</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">: [</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">            </span></span><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">                </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">Key</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">Product</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">                </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">Value</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">Guardium</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">            </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">]</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="{    &#x22;Policy&#x22;: {        &#x22;PolicyName&#x22;: &#x22;AmazonEKS_EBS_CSI_Driver_Policy&#x22;,        &#x22;PolicyId&#x22;: &#x22;ANPA24LVTCGN5YOUAVX2V&#x22;,        &#x22;Arn&#x22;: &#x22;arn:aws:iam::<ACCOUNT ID>:policy/AmazonEKS_EBS_CSI_Driver_Policy&#x22;,        &#x22;Path&#x22;: &#x22;/&#x22;,        &#x22;DefaultVersionId&#x22;: &#x22;v1&#x22;,        &#x22;AttachmentCount&#x22;: 0,        &#x22;PermissionsBoundaryUsageCount&#x22;: 0,        &#x22;IsAttachable&#x22;: true,        &#x22;CreateDate&#x22;: &#x22;2023-04-19T14:17:03+00:00&#x22;,        &#x22;UpdateDate&#x22;: &#x22;2023-04-19T14:17:03+00:00&#x22;,        &#x22;Tags&#x22;: [            {                &#x22;Key&#x22;: &#x22;Product&#x22;,                &#x22;Value&#x22;: &#x22;Guardium&#x22;            }        ]    }}"><div></div></button></div></figure></div>
<p>Let’s export the returned arn as a env VAR for further use</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">export</span><span style="--0:#D6DEEB;--1:#403F53"> ebs_driver_policy_arn</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#82AAFF;--1:#3C63B3">$</span><span style="--0:#D6DEEB;--1:#403F53">(aws iam list</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">policies </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">query </span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">Policies[?PolicyName==`AmazonEKS_EBS_CSI_Driver_Policy`].Arn</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">output text)</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="export ebs_driver_policy_arn=$(aws iam list-policies --query &#x27;Policies[?PolicyName==&#x60;AmazonEKS_EBS_CSI_Driver_Policy&#x60;].Arn&#x27; --output text)"><div></div></button></div></figure></div>
<p>Now let’s export the rolename we are going to create as a env var. We’re going to append the cluster name to the role to differentiate in case we have multiple clusters in this account. You can share policies, but you cannot share roles.</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">export</span><span style="--0:#D6DEEB;--1:#403F53"> ebs_driver_role_name</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53">AmazonEKS_EBS_CSI_DriverRole</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">${clustername}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="export ebs_driver_role_name=AmazonEKS_EBS_CSI_DriverRole-${clustername}"><div></div></button></div></figure></div>
<p>Create the service account</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">eksctl create iamserviceaccount \</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">name ebs</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">csi</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">controller</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">sa \</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#C792EA;--1:#8D46B4">namespace</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#FFCB8B;--1:#111111">kube</span><span style="--0:#D6DEEB;--1:#403F53">-</span><span style="--0:#FFCB8B;--1:#111111">system</span><span style="--0:#D6DEEB;--1:#403F53"> \</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">--</span><span style="--0:#FFCB8B;--1:#111111">cluster</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#FFCB8B;--1:#111111">$</span><span style="--0:#D6DEEB;--1:#403F53">{clustername} \</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">attach</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">policy</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">arn $ebs_driver_policy_arn \</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">approve \</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">region</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53">${region} \</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">tags </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">Product=Guardium</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> \</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">role</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">only \</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">role</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">name ${ebs_driver_role_name}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="eksctl create iamserviceaccount \  --name ebs-csi-controller-sa \  --namespace kube-system \  --cluster ${clustername} \  --attach-policy-arn $ebs_driver_policy_arn \  --approve \  --region=${region} \  --tags &#x22;Product=Guardium&#x22; \  --role-only \  --role-name ${ebs_driver_role_name}"><div></div></button></div></figure></div>
<p>Let’s export the created role arn as another env var</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">export</span><span style="--0:#D6DEEB;--1:#403F53"> ebs_driver_role_arn</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#82AAFF;--1:#3C63B3">$</span><span style="--0:#D6DEEB;--1:#403F53">(aws iam list</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">roles </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">query </span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">Roles[?RoleName==`AmazonEKS_EBS_CSI_DriverRole-</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#D6DEEB;--1:#403F53">$clustername</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">`].Arn</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">output text)</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="export ebs_driver_role_arn=$(aws iam list-roles --query &#x27;Roles[?RoleName==&#x60;AmazonEKS_EBS_CSI_DriverRole-&#x27;$clustername&#x27;&#x60;].Arn&#x27; --output text)"><div></div></button></div></figure></div>
<p>Create the addon for the cluster</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">eksctl create addon \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">name aws</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">ebs</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">csi</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">driver \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">cluster ${clustername} \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">service</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">account</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">role</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">arn $ebs_driver_role_arn \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">region</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53">${region} \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">force</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="eksctl create addon \--name aws-ebs-csi-driver \--cluster ${clustername} \--service-account-role-arn $ebs_driver_role_arn \--region=${region} \--force"><div></div></button></div></figure></div>
<p>Create the following StorageClass yaml to use gp3</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">cat </span><span style="--0:#C792EA;--1:#8D46B4">&#x3C;&#x3C;</span><span style="--0:#82AAFF;--1:#3C63B3">EOF</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">|</span><span style="--0:#D6DEEB;--1:#403F53">kubectl apply </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">f </span><span style="--0:#C792EA;--1:#8D46B4">-</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">apiVersion: storage</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">k8s</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">io</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#D6DEEB;--1:#403F53">v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">kind: StorageClass</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">metadata:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">name: ebs</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">gp3</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">sc</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">provisioner: ebs</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">csi</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">aws</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">com</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">parameters:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">type: gp3</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">fsType: ext4</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">reclaimPolicy: Delete</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">volumeBindingMode: WaitForFirstConsumer</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">EOF</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="cat <<EOF |kubectl apply -f -apiVersion: storage.k8s.io/v1kind: StorageClassmetadata:  name: ebs-gp3-scprovisioner: ebs.csi.aws.comparameters:  type: gp3  fsType: ext4reclaimPolicy: DeletevolumeBindingMode: WaitForFirstConsumerEOF"><div></div></button></div></figure></div>
<h3 id="verifying-ebs">Verifying EBS</h3>
<p>Run the following command</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">kubectl apply </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">f </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">&#x3C;&#x3C;</span><span style="--0:#82AAFF;--1:#3C63B3">EOF</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">apiVersion: v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">kind: PersistentVolumeClaim</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">metadata:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">name: block</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">pvc</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">spec:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">storageClassName: ebs</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">gp3</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">sc</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">accessModes:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53"> ReadWriteOnce</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">resources:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">requests:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">      </span></span><span style="--0:#D6DEEB;--1:#403F53">storage: 1Gi</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#C792EA;--1:#8D46B4">-</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">apiVersion: v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">kind: Pod</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">metadata:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">name: mypod</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">spec:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">containers:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53"> name: myfrontend</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">      </span></span><span style="--0:#D6DEEB;--1:#403F53">image: nginx</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">      </span></span><span style="--0:#D6DEEB;--1:#403F53">volumeMounts:</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53"> mountPath: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">/var/www/html</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">          </span></span><span style="--0:#D6DEEB;--1:#403F53">name: mypd</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">volumes:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53"> name: mypd</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">      </span></span><span style="--0:#D6DEEB;--1:#403F53">persistentVolumeClaim:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">claimName: block</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">pvc</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">EOF</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="kubectl apply -f - <<EOFapiVersion: v1kind: PersistentVolumeClaimmetadata:  name: block-pvcspec:  storageClassName: ebs-gp3-sc  accessModes:    - ReadWriteOnce  resources:    requests:      storage: 1Gi---apiVersion: v1kind: Podmetadata:  name: mypodspec:  containers:    - name: myfrontend      image: nginx      volumeMounts:        - mountPath: &#x22;/var/www/html&#x22;          name: mypd  volumes:    - name: mypd      persistentVolumeClaim:        claimName: block-pvcEOF"><div></div></button></div></figure></div>
<p>Verify the PVC was created</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">kubectl get pvc</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">        </span><span style="--0:#82AAFF;--1:#3C63B3">STATUS</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#82AAFF;--1:#3C63B3">VOLUME</span><span style="--0:#D6DEEB;--1:#403F53">                                     </span><span style="--0:#82AAFF;--1:#3C63B3">CAPACITY</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#82AAFF;--1:#3C63B3">ACCESS</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">MODES</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#82AAFF;--1:#3C63B3">STORAGECLASS</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#82AAFF;--1:#3C63B3">VOLUMEATTRIBUTESCLASS</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#82AAFF;--1:#3C63B3">AGE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">block</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">pvc   Bound    pvc</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#F78C6C;--1:#AA0982">67193212</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#F78C6C;--1:#AA0982">3e10</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">46ab</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">a0a4</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">2834e3560c4a   1Gi        </span><span style="--0:#82AAFF;--1:#3C63B3">RWO</span><span style="--0:#D6DEEB;--1:#403F53">            ebs</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">gp3</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">sc     </span><span style="--0:#C792EA;--1:#8D46B4">&#x3C;</span><span style="--0:#D6DEEB;--1:#403F53">unset</span><span style="--0:#C792EA;--1:#8D46B4">></span><span style="--0:#D6DEEB;--1:#403F53">                 7s</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="kubectl get pvcNAME        STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS   VOLUMEATTRIBUTESCLASS   AGEblock-pvc   Bound    pvc-67193212-3e10-46ab-a0a4-2834e3560c4a   1Gi        RWO            ebs-gp3-sc     <unset>                 7s"><div></div></button></div></figure></div>
<p>You should see the bound status of the above pvc.</p>
<p>Delete the test pod and pvc</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">kubectl </span><span style="--0:#7FDBCA;--1:#097174">delete</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">f </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">&#x3C;&#x3C;</span><span style="--0:#82AAFF;--1:#3C63B3">EOF</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">apiVersion: v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">kind: PersistentVolumeClaim</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">metadata:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">name: block</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">pvc</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">spec:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">storageClassName: ebs</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">gp3</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">sc</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">accessModes:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53"> ReadWriteOnce</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">resources:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">requests:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">      </span></span><span style="--0:#D6DEEB;--1:#403F53">storage: 1Gi</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#C792EA;--1:#8D46B4">-</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">apiVersion: v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">kind: Pod</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">metadata:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">name: mypod</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">spec:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">containers:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53"> name: myfrontend</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">      </span></span><span style="--0:#D6DEEB;--1:#403F53">image: nginx</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">      </span></span><span style="--0:#D6DEEB;--1:#403F53">volumeMounts:</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53"> mountPath: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">/var/www/html</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">          </span></span><span style="--0:#D6DEEB;--1:#403F53">name: mypd</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">volumes:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53"> name: mypd</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">      </span></span><span style="--0:#D6DEEB;--1:#403F53">persistentVolumeClaim:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">claimName: block</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">pvc</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">EOF</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="kubectl delete -f - <<EOFapiVersion: v1kind: PersistentVolumeClaimmetadata:  name: block-pvcspec:  storageClassName: ebs-gp3-sc  accessModes:    - ReadWriteOnce  resources:    requests:      storage: 1Gi---apiVersion: v1kind: Podmetadata:  name: mypodspec:  containers:    - name: myfrontend      image: nginx      volumeMounts:        - mountPath: &#x22;/var/www/html&#x22;          name: mypd  volumes:    - name: mypd      persistentVolumeClaim:        claimName: block-pvcEOF"><div></div></button></div></figure></div>
<h2 id="enable-efs-on-the-cluster">Enable EFS on the cluster</h2>
<p>By default when we create a cluster with eksctl it defines and installs <code dir="auto">gp2</code> storage class which is backed by Amazon’s EBS (elastic block storage). After that we installed the EBS CSI driver to support <code dir="auto">gp3</code>. However, both <code dir="auto">gp2</code> and <code dir="auto">gp3</code> are both block storage. They will not support RWX in our cluster. We need to install an EFS storage class.</p>
<h3 id="create-iam-policy">Create IAM policy</h3>
<p>Download the IAM policy document from GitHub. You can also view the <a href="https://github.com/kubernetes-sigs/aws-efs-csi-driver/blob/master/docs/iam-policy-example.json">policy document</a></p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">curl </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">o iam</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">policy</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">example</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">efs</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">json</span><span style="--0:#D6DEEB;--1:#403F53"> https:</span><span style="--0:#809191;--1:#5E6578">//raw.githubusercontent.com/kubernetes-sigs/aws-efs-csi-driver/master/docs/iam-policy-example.json</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="curl -o iam-policy-example-efs.json https://raw.githubusercontent.com/kubernetes-sigs/aws-efs-csi-driver/master/docs/iam-policy-example.json"><div></div></button></div></figure></div>
<p>Create the policy. You can change <code dir="auto">AmazonEKS_EFS_CSI_Driver_Policy</code> to a different name, but if you do, make sure to change it in later steps too.</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">aws iam create</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">policy \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">policy</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">name AmazonEKS_EFS_CSI_Driver_Policy \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">tags </span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">{"Key": "Product","Value": "Guardium"}</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#D6DEEB;--1:#403F53"> \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">policy</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">document file:</span><span style="--0:#809191;--1:#5E6578">//iam-policy-example-efs.json</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="aws iam create-policy \--policy-name AmazonEKS_EFS_CSI_Driver_Policy \--tags &#x27;{&#x22;Key&#x22;: &#x22;Product&#x22;,&#x22;Value&#x22;: &#x22;Guardium&#x22;}&#x27; \--policy-document file://iam-policy-example-efs.json"><div></div></button></div></figure></div>
<p>Output should be similar to below</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">Policy</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">: {</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">PolicyName</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">AmazonEKS_EFS_CSI_Driver_Policy</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">PolicyId</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">ANPA3WENOYSA6LSFRSZ6U</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">Arn</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">arn:aws:iam::803455550593:policy/AmazonEKS_EFS_CSI_Driver_Policy</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">Path</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">/</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">DefaultVersionId</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">v1</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">AttachmentCount</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">PermissionsBoundaryUsageCount</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">IsAttachable</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#FF5874;--1:#A54A4A">true</span><span style="--0:#D6DEEB;--1:#403F53">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">CreateDate</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">2024-08-23T19:57:13+00:00</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">UpdateDate</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">2024-08-23T19:57:13+00:00</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">Tags</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">: [</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">            </span></span><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">                </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">Key</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">Product</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">                </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">Value</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">Guardium</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">            </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">]</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="{    &#x22;Policy&#x22;: {        &#x22;PolicyName&#x22;: &#x22;AmazonEKS_EFS_CSI_Driver_Policy&#x22;,        &#x22;PolicyId&#x22;: &#x22;ANPA3WENOYSA6LSFRSZ6U&#x22;,        &#x22;Arn&#x22;: &#x22;arn:aws:iam::803455550593:policy/AmazonEKS_EFS_CSI_Driver_Policy&#x22;,        &#x22;Path&#x22;: &#x22;/&#x22;,        &#x22;DefaultVersionId&#x22;: &#x22;v1&#x22;,        &#x22;AttachmentCount&#x22;: 0,        &#x22;PermissionsBoundaryUsageCount&#x22;: 0,        &#x22;IsAttachable&#x22;: true,        &#x22;CreateDate&#x22;: &#x22;2024-08-23T19:57:13+00:00&#x22;,        &#x22;UpdateDate&#x22;: &#x22;2024-08-23T19:57:13+00:00&#x22;,        &#x22;Tags&#x22;: [            {                &#x22;Key&#x22;: &#x22;Product&#x22;,                &#x22;Value&#x22;: &#x22;Guardium&#x22;            }        ]    }}"><div></div></button></div></figure></div>
<p>Let’s export that policy arn as another env var</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">export</span><span style="--0:#D6DEEB;--1:#403F53"> efs_driver_policy_arn</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#82AAFF;--1:#3C63B3">$</span><span style="--0:#D6DEEB;--1:#403F53">(aws iam list</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">policies </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">query </span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">Policies[?PolicyName==`AmazonEKS_EFS_CSI_Driver_Policy`].Arn</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">output text)</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="export efs_driver_policy_arn=$(aws iam list-policies --query &#x27;Policies[?PolicyName==&#x60;AmazonEKS_EFS_CSI_Driver_Policy&#x60;].Arn&#x27; --output text)"><div></div></button></div></figure></div>
<h3 id="create-iam-role">Create IAM role</h3>
<p>Now let’s export the rolename we are going to create as a env var. We’re going to append the cluster name to the role to differentiate in case we have multiple clusters in this account. You can share policies, but you cannot share roles.</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">export</span><span style="--0:#D6DEEB;--1:#403F53"> efs_driver_role_name</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53">AmazonEKS_EFS_CSI_DriverRole</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">${clustername}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="export efs_driver_role_name=AmazonEKS_EFS_CSI_DriverRole-${clustername}"><div></div></button></div></figure></div>
<p>Create an IAM role and attach the IAM policy to it. Annotate the Kubernetes service account with the IAM role ARN and the IAM role with the Kubernetes service account name.</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">eksctl create iamserviceaccount \</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">cluster ${clustername} \</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#C792EA;--1:#8D46B4">namespace</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#FFCB8B;--1:#111111">kube</span><span style="--0:#D6DEEB;--1:#403F53">-</span><span style="--0:#FFCB8B;--1:#111111">system</span><span style="--0:#D6DEEB;--1:#403F53"> \</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">--</span><span style="--0:#FFCB8B;--1:#111111">name</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#FFCB8B;--1:#111111">efs</span><span style="--0:#D6DEEB;--1:#403F53">-</span><span style="--0:#FFCB8B;--1:#111111">csi</span><span style="--0:#D6DEEB;--1:#403F53">-</span><span style="--0:#FFCB8B;--1:#111111">controller</span><span style="--0:#D6DEEB;--1:#403F53">-</span><span style="--0:#FFCB8B;--1:#111111">sa</span><span style="--0:#D6DEEB;--1:#403F53"> \</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">--</span><span style="--0:#FFCB8B;--1:#111111">role</span><span style="--0:#D6DEEB;--1:#403F53">-</span><span style="--0:#FFCB8B;--1:#111111">name</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#FFCB8B;--1:#111111">$</span><span style="--0:#D6DEEB;--1:#403F53">{efs_driver_role_name} \</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">attach</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">policy</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">arn $efs_driver_policy_arn \</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">tags </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">Product=Guardium</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> \</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">approve \</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">region ${region}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="eksctl create iamserviceaccount \    --cluster ${clustername} \    --namespace kube-system \    --name efs-csi-controller-sa \    --role-name ${efs_driver_role_name} \    --attach-policy-arn $efs_driver_policy_arn \    --tags &#x22;Product=Guardium&#x22; \    --approve \    --region ${region}"><div></div></button></div></figure></div>
<p>Once created, check the iam service account is created running the following command.</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">eksctl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">get</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">iamserviceaccount</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">--cluster</span><span style="--0:#D6DEEB;--1:#403F53"> ${</span><span style="--0:#C5E478;--1:#3C63B3">clustername</span><span style="--0:#D6DEEB;--1:#403F53">} </span><span style="--0:#82AAFF;--1:#3C63B3">--region</span><span style="--0:#D6DEEB;--1:#403F53"> ${</span><span style="--0:#C5E478;--1:#3C63B3">region</span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="eksctl get iamserviceaccount --cluster ${clustername} --region ${region}"><div></div></button></div></figure></div>
<p>Should return</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAMESPACE</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#82AAFF;--1:#3C63B3">ROLE</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">ARN</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">kube</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">system  ebs</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">csi</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">controller</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">sa  arn:aws:iam::</span><span style="--0:#F78C6C;--1:#AA0982">803455550593</span><span style="--0:#D6DEEB;--1:#403F53">:role</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#D6DEEB;--1:#403F53">AmazonEKS_EBS_CSI_DriverRole</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">kube</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">system  efs</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">csi</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">controller</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">sa  arn:aws:iam::</span><span style="--0:#F78C6C;--1:#AA0982">803455550593</span><span style="--0:#D6DEEB;--1:#403F53">:role</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#D6DEEB;--1:#403F53">AmazonEKS_EFS_CSI_DriverRole</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="NAMESPACE  NAME      ROLE ARNkube-system  ebs-csi-controller-sa  arn:aws:iam::803455550593:role/AmazonEKS_EBS_CSI_DriverRolekube-system  efs-csi-controller-sa  arn:aws:iam::803455550593:role/AmazonEKS_EFS_CSI_DriverRole"><div></div></button></div></figure></div>
<h3 id="install-efs-csi-driver">Install EFS CSI driver</h3>
<p>Now we just need our add-on registry address. This can be found here: <a href="https://docs.aws.amazon.com/eks/latest/userguide/add-ons-images.html">https://docs.aws.amazon.com/eks/latest/userguide/add-ons-images.html</a></p>
<aside aria-label="Note" class="starlight-aside starlight-aside--note"><p class="starlight-aside__title" aria-hidden="true"><svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="starlight-aside__icon"><path d="M12 11C11.7348 11 11.4804 11.1054 11.2929 11.2929C11.1054 11.4804 11 11.7348 11 12V16C11 16.2652 11.1054 16.5196 11.2929 16.7071C11.4804 16.8946 11.7348 17 12 17C12.2652 17 12.5196 16.8946 12.7071 16.7071C12.8946 16.5196 13 16.2652 13 16V12C13 11.7348 12.8946 11.4804 12.7071 11.2929C12.5196 11.1054 12.2652 11 12 11ZM12.38 7.08C12.1365 6.97998 11.8635 6.97998 11.62 7.08C11.4973 7.12759 11.3851 7.19896 11.29 7.29C11.2017 7.3872 11.1306 7.49882 11.08 7.62C11.024 7.73868 10.9966 7.86882 11 8C10.9992 8.13161 11.0245 8.26207 11.0742 8.38391C11.124 8.50574 11.1973 8.61656 11.29 8.71C11.3872 8.79833 11.4988 8.86936 11.62 8.92C11.7715 8.98224 11.936 9.00632 12.099 8.99011C12.2619 8.97391 12.4184 8.91792 12.5547 8.82707C12.691 8.73622 12.8029 8.61328 12.8805 8.46907C12.9582 8.32486 12.9992 8.16378 13 8C12.9963 7.73523 12.8927 7.48163 12.71 7.29C12.6149 7.19896 12.5028 7.12759 12.38 7.08ZM12 2C10.0222 2 8.08879 2.58649 6.4443 3.6853C4.79981 4.78412 3.51809 6.3459 2.76121 8.17317C2.00433 10.0004 1.8063 12.0111 2.19215 13.9509C2.578 15.8907 3.53041 17.6725 4.92894 19.0711C6.32746 20.4696 8.10929 21.422 10.0491 21.8079C11.9889 22.1937 13.9996 21.9957 15.8268 21.2388C17.6541 20.4819 19.2159 19.2002 20.3147 17.5557C21.4135 15.9112 22 13.9778 22 12C22 10.6868 21.7413 9.38642 21.2388 8.17317C20.7363 6.95991 19.9997 5.85752 19.0711 4.92893C18.1425 4.00035 17.0401 3.26375 15.8268 2.7612C14.6136 2.25866 13.3132 2 12 2ZM12 20C10.4178 20 8.87104 19.5308 7.55544 18.6518C6.23985 17.7727 5.21447 16.5233 4.60897 15.0615C4.00347 13.5997 3.84504 11.9911 4.15372 10.4393C4.4624 8.88743 5.22433 7.46197 6.34315 6.34315C7.46197 5.22433 8.88743 4.4624 10.4393 4.15372C11.9911 3.84504 13.5997 4.00346 15.0615 4.60896C16.5233 5.21447 17.7727 6.23984 18.6518 7.55544C19.5308 8.87103 20 10.4177 20 12C20 14.1217 19.1572 16.1566 17.6569 17.6569C16.1566 19.1571 14.1217 20 12 20Z"></path></svg>Note</p><section class="starlight-aside__content"><p>The add-on registry address is per region. So based on the URL above, since our region is <code dir="auto">us-east-1</code>, then our registry address would be <code dir="auto">602401143452.dkr.ecr.us-east-1.amazonaws.com/eks/aws-efs-csi-driver</code></p></section></aside>
<p>Let’s install the driver add-on to our clusters. We’re going to use <code dir="auto">helm</code> for this.</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">helm repo add aws</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">efs</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">csi</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">driver https:</span><span style="--0:#809191;--1:#5E6578">//kubernetes-sigs.github.io/aws-efs-csi-driver/</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">helm repo update</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="helm repo add aws-efs-csi-driver https://kubernetes-sigs.github.io/aws-efs-csi-driver/helm repo update"><div></div></button></div></figure></div>
<p>Install a release of the driver using the Helm chart. Replace the repository address with the cluster’s <a href="https://docs.aws.amazon.com/eks/latest/userguide/add-ons-images.html">container image address</a>.</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">helm upgrade </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">i aws</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">efs</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">csi</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">driver aws</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">efs</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">csi</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">driver</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#D6DEEB;--1:#403F53">aws</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">efs</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">csi</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">driver \</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#C792EA;--1:#8D46B4">namespace</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#FFCB8B;--1:#111111">kube</span><span style="--0:#D6DEEB;--1:#403F53">-</span><span style="--0:#FFCB8B;--1:#111111">system</span><span style="--0:#D6DEEB;--1:#403F53"> \</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">--</span><span style="--0:#FFCB8B;--1:#111111">set</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#FFCB8B;--1:#111111">image</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FFCB8B;--1:#111111">repository</span><span style="--0:#D6DEEB;--1:#403F53">=602401143452</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FFCB8B;--1:#111111">dkr</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FFCB8B;--1:#111111">ecr</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FFCB8B;--1:#111111">us</span><span style="--0:#D6DEEB;--1:#403F53">-</span><span style="--0:#FFCB8B;--1:#111111">east</span><span style="--0:#D6DEEB;--1:#403F53">-1</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FFCB8B;--1:#111111">amazonaws</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FFCB8B;--1:#111111">com</span><span style="--0:#D6DEEB;--1:#403F53">/</span><span style="--0:#FFCB8B;--1:#111111">eks</span><span style="--0:#D6DEEB;--1:#403F53">/</span><span style="--0:#FFCB8B;--1:#111111">aws</span><span style="--0:#D6DEEB;--1:#403F53">-</span><span style="--0:#FFCB8B;--1:#111111">efs</span><span style="--0:#D6DEEB;--1:#403F53">-</span><span style="--0:#FFCB8B;--1:#111111">csi</span><span style="--0:#D6DEEB;--1:#403F53">-</span><span style="--0:#FFCB8B;--1:#111111">driver</span><span style="--0:#D6DEEB;--1:#403F53"> \</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">--</span><span style="--0:#FFCB8B;--1:#111111">set</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#FFCB8B;--1:#111111">controller</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FFCB8B;--1:#111111">serviceAccount</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FFCB8B;--1:#111111">create</span><span style="--0:#D6DEEB;--1:#403F53">=</span><span style="--0:#FFCB8B;--1:#111111">false</span><span style="--0:#D6DEEB;--1:#403F53"> \</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">--</span><span style="--0:#FFCB8B;--1:#111111">set</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#FFCB8B;--1:#111111">controller</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FFCB8B;--1:#111111">serviceAccount</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FFCB8B;--1:#111111">name</span><span style="--0:#D6DEEB;--1:#403F53">=</span><span style="--0:#FFCB8B;--1:#111111">efs</span><span style="--0:#D6DEEB;--1:#403F53">-</span><span style="--0:#FFCB8B;--1:#111111">csi</span><span style="--0:#D6DEEB;--1:#403F53">-</span><span style="--0:#FFCB8B;--1:#111111">controller</span><span style="--0:#D6DEEB;--1:#403F53">-</span><span style="--0:#FFCB8B;--1:#111111">sa</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="helm upgrade -i aws-efs-csi-driver aws-efs-csi-driver/aws-efs-csi-driver \    --namespace kube-system \    --set image.repository=602401143452.dkr.ecr.us-east-1.amazonaws.com/eks/aws-efs-csi-driver \    --set controller.serviceAccount.create=false \    --set controller.serviceAccount.name=efs-csi-controller-sa"><div></div></button></div></figure></div>
<p>Verify that it installed correctly with this command</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">kubectl get pod </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">n kube</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">system </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">l </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">app.kubernetes.io/name=aws-efs-csi-driver,app.kubernetes.io/instance=aws-efs-csi-driver</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="kubectl get pod -n kube-system -l &#x22;app.kubernetes.io/name=aws-efs-csi-driver,app.kubernetes.io/instance=aws-efs-csi-driver&#x22;"><div></div></button></div></figure></div>
<p>Should return something like</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">                                  </span><span style="--0:#82AAFF;--1:#3C63B3">READY</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#82AAFF;--1:#3C63B3">STATUS</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#82AAFF;--1:#3C63B3">RESTARTS</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#82AAFF;--1:#3C63B3">AGE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">efs</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">csi</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">controller</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">7fc77768fc</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">2swkw   </span><span style="--0:#F78C6C;--1:#AA0982">3</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#F78C6C;--1:#AA0982">3</span><span style="--0:#D6DEEB;--1:#403F53">     Running   </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">          2m13s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">efs</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">csi</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">controller</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">7fc77768fc</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">c69rb   </span><span style="--0:#F78C6C;--1:#AA0982">3</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#F78C6C;--1:#AA0982">3</span><span style="--0:#D6DEEB;--1:#403F53">     Running   </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">          2m13s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">efs</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">csi</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">node</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">ccxns                    </span><span style="--0:#F78C6C;--1:#AA0982">3</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#F78C6C;--1:#AA0982">3</span><span style="--0:#D6DEEB;--1:#403F53">     Running   </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">          2d17h</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">efs</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">csi</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">node</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">k52pt                    </span><span style="--0:#F78C6C;--1:#AA0982">3</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#F78C6C;--1:#AA0982">3</span><span style="--0:#D6DEEB;--1:#403F53">     Running   </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">          2d17h</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">efs</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">csi</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">node</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">r8nbm                    </span><span style="--0:#F78C6C;--1:#AA0982">3</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#F78C6C;--1:#AA0982">3</span><span style="--0:#D6DEEB;--1:#403F53">     Running   </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">          2d17h</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="NAME                                  READY   STATUS    RESTARTS   AGEefs-csi-controller-7fc77768fc-2swkw   3/3     Running   0          2m13sefs-csi-controller-7fc77768fc-c69rb   3/3     Running   0          2m13sefs-csi-node-ccxns                    3/3     Running   0          2d17hefs-csi-node-k52pt                    3/3     Running   0          2d17hefs-csi-node-r8nbm                    3/3     Running   0          2d17h"><div></div></button></div></figure></div>
<h3 id="create-the-efs-filesystem">Create the EFS Filesystem</h3>
<p>Now we need to create the filesystem in EFS so we can use it</p>
<p>Export the following variables.</p>
<p>Get our VPC ID</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">vpc_id</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#82AAFF;--1:#3C63B3">$</span><span style="--0:#D6DEEB;--1:#403F53">(aws eks describe</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">cluster \</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">name $clustername \</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">query </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">cluster.resourcesVpcConfig.vpcId</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> \</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">region $region \</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">output text)</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="vpc_id=$(aws eks describe-cluster \    --name $clustername \    --query &#x22;cluster.resourcesVpcConfig.vpcId&#x22; \    --region $region \    --output text)"><div></div></button></div></figure></div>
<p>Retrieve the CIDR range for your cluster’s VPC and store it in a variable for use in a later step.</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">cidr_range</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#82AAFF;--1:#3C63B3">$</span><span style="--0:#D6DEEB;--1:#403F53">(aws ec2 describe</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">vpcs \</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">vpc</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">ids $vpc_id \</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">query </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">Vpcs[].CidrBlock</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> \</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">output text \</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">region $region)</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="cidr_range=$(aws ec2 describe-vpcs \    --vpc-ids $vpc_id \    --query &#x22;Vpcs[].CidrBlock&#x22; \    --output text \    --region $region)"><div></div></button></div></figure></div>
<p>Create a security group with an inbound rule that allows inbound NFS traffic for your Amazon EFS mount points.</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">security_group_id</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#82AAFF;--1:#3C63B3">$</span><span style="--0:#D6DEEB;--1:#403F53">(aws ec2 create</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">security</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">group \</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">group</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">name EFS4FileNetSecurityGroup \</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">description </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">EFS security group for Guardium Insight Clusters</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> \</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">vpc</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">id $vpc_id \</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">region $region \</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">output text)</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="security_group_id=$(aws ec2 create-security-group \    --group-name EFS4FileNetSecurityGroup \    --description &#x22;EFS security group for Guardium Insight Clusters&#x22; \    --vpc-id $vpc_id \    --region $region \    --output text)"><div></div></button></div></figure></div>
<p>Create an inbound rule that allows inbound NFS traffic from the CIDR for your cluster’s VPC.</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">aws ec2 authorize</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">security</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">group</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">ingress \</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">group</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">id $security_group_id \</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">protocol tcp \</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">port </span><span style="--0:#F78C6C;--1:#AA0982">2049</span><span style="--0:#D6DEEB;--1:#403F53"> \</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">region $region \</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">cidr $cidr_range</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="aws ec2 authorize-security-group-ingress \    --group-id $security_group_id \    --protocol tcp \    --port 2049 \    --region $region \    --cidr $cidr_range"><div></div></button></div></figure></div>
<p>Create a file system.</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">file_system_id</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#82AAFF;--1:#3C63B3">$</span><span style="--0:#D6DEEB;--1:#403F53">(aws efs create</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">file</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">system \</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">region $region \</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">encrypted \</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">tags </span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">{"Key": "Product","Value": "Guardium"}</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#D6DEEB;--1:#403F53"> \</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">performance</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">mode generalPurpose \</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">query </span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">FileSystemId</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#D6DEEB;--1:#403F53"> \</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">output text)</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="file_system_id=$(aws efs create-file-system \    --region $region \    --encrypted \    --tags &#x27;{&#x22;Key&#x22;: &#x22;Product&#x22;,&#x22;Value&#x22;: &#x22;Guardium&#x22;}&#x27; \    --performance-mode generalPurpose \    --query &#x27;FileSystemId&#x27; \    --output text)"><div></div></button></div></figure></div>
<p>Create mount targets.</p>
<p>Determine the IDs of the subnets in your VPC and which Availability Zone the subnet is in.</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">aws ec2 describe</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">subnets \</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">filters </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">Name=vpc-id,Values=$vpc_id</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> \</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">query </span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">Subnets[*].{SubnetId: SubnetId,AvailabilityZone: AvailabilityZone,CidrBlock: CidrBlock}</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#D6DEEB;--1:#403F53"> \</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">region $region \</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">output table</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="aws ec2 describe-subnets \    --filters &#x22;Name=vpc-id,Values=$vpc_id&#x22; \    --query &#x27;Subnets[*].{SubnetId: SubnetId,AvailabilityZone: AvailabilityZone,CidrBlock: CidrBlock}&#x27; \    --region $region \    --output table"><div></div></button></div></figure></div>
<p>Should output something like the following</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">----------------------------------------------------------------------</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">|</span><span style="--0:#D6DEEB;--1:#403F53">                           DescribeSubnets                          </span><span style="--0:#C792EA;--1:#8D46B4">|</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">+</span><span style="--0:#7FDBCA;--1:#097174">------------------</span><span style="--0:#C792EA;--1:#8D46B4">+</span><span style="--0:#7FDBCA;--1:#097174">--------------------</span><span style="--0:#C792EA;--1:#8D46B4">+</span><span style="--0:#7FDBCA;--1:#097174">----------------------------</span><span style="--0:#C792EA;--1:#8D46B4">+</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">|</span><span style="--0:#D6DEEB;--1:#403F53"> AvailabilityZone </span><span style="--0:#C792EA;--1:#8D46B4">|</span><span style="--0:#D6DEEB;--1:#403F53">     CidrBlock      </span><span style="--0:#C792EA;--1:#8D46B4">|</span><span style="--0:#D6DEEB;--1:#403F53">         SubnetId           </span><span style="--0:#C792EA;--1:#8D46B4">|</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">+</span><span style="--0:#7FDBCA;--1:#097174">------------------</span><span style="--0:#C792EA;--1:#8D46B4">+</span><span style="--0:#7FDBCA;--1:#097174">--------------------</span><span style="--0:#C792EA;--1:#8D46B4">+</span><span style="--0:#7FDBCA;--1:#097174">----------------------------</span><span style="--0:#C792EA;--1:#8D46B4">+</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">|</span><span style="--0:#D6DEEB;--1:#403F53">  us</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">east</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">1c      </span><span style="--0:#C792EA;--1:#8D46B4">|</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">192.168</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#F78C6C;--1:#AA0982">64.0</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#F78C6C;--1:#AA0982">19</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#C792EA;--1:#8D46B4">|</span><span style="--0:#D6DEEB;--1:#403F53">  subnet</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">08c33dce5e63c82dc  </span><span style="--0:#C792EA;--1:#8D46B4">|</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">|</span><span style="--0:#D6DEEB;--1:#403F53">  us</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">east</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">1b      </span><span style="--0:#C792EA;--1:#8D46B4">|</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">192.168</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#F78C6C;--1:#AA0982">32.0</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#F78C6C;--1:#AA0982">19</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#C792EA;--1:#8D46B4">|</span><span style="--0:#D6DEEB;--1:#403F53">  subnet</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">0f7a2b449320cc1e6  </span><span style="--0:#C792EA;--1:#8D46B4">|</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">|</span><span style="--0:#D6DEEB;--1:#403F53">  us</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">east</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">1a      </span><span style="--0:#C792EA;--1:#8D46B4">|</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">192.168</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#F78C6C;--1:#AA0982">0.0</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#F78C6C;--1:#AA0982">19</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#C792EA;--1:#8D46B4">|</span><span style="--0:#D6DEEB;--1:#403F53">  subnet</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">0ec499ae3eae19eb0  </span><span style="--0:#C792EA;--1:#8D46B4">|</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">|</span><span style="--0:#D6DEEB;--1:#403F53">  us</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">east</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">1b      </span><span style="--0:#C792EA;--1:#8D46B4">|</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">192.168</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#F78C6C;--1:#AA0982">128.0</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#F78C6C;--1:#AA0982">19</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#C792EA;--1:#8D46B4">|</span><span style="--0:#D6DEEB;--1:#403F53">  subnet</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">04f3d465138687333  </span><span style="--0:#C792EA;--1:#8D46B4">|</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">|</span><span style="--0:#D6DEEB;--1:#403F53">  us</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">east</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">1a      </span><span style="--0:#C792EA;--1:#8D46B4">|</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">192.168</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#F78C6C;--1:#AA0982">96.0</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#F78C6C;--1:#AA0982">19</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#C792EA;--1:#8D46B4">|</span><span style="--0:#D6DEEB;--1:#403F53">  subnet</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">0bc4d31344c60c113  </span><span style="--0:#C792EA;--1:#8D46B4">|</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">|</span><span style="--0:#D6DEEB;--1:#403F53">  us</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">east</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">1c      </span><span style="--0:#C792EA;--1:#8D46B4">|</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#F78C6C;--1:#AA0982">192.168</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#F78C6C;--1:#AA0982">160.0</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#F78C6C;--1:#AA0982">19</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#C792EA;--1:#8D46B4">|</span><span style="--0:#D6DEEB;--1:#403F53">  subnet</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">0bee6fc06187cafd1  </span><span style="--0:#C792EA;--1:#8D46B4">|</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">+</span><span style="--0:#7FDBCA;--1:#097174">------------------</span><span style="--0:#C792EA;--1:#8D46B4">+</span><span style="--0:#7FDBCA;--1:#097174">--------------------</span><span style="--0:#C792EA;--1:#8D46B4">+</span><span style="--0:#7FDBCA;--1:#097174">----------------------------</span><span style="--0:#C792EA;--1:#8D46B4">+</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="----------------------------------------------------------------------|                           DescribeSubnets                          |+------------------+--------------------+----------------------------+| AvailabilityZone |     CidrBlock      |         SubnetId           |+------------------+--------------------+----------------------------+|  us-east-1c      |  192.168.64.0/19   |  subnet-08c33dce5e63c82dc  ||  us-east-1b      |  192.168.32.0/19   |  subnet-0f7a2b449320cc1e6  ||  us-east-1a      |  192.168.0.0/19    |  subnet-0ec499ae3eae19eb0  ||  us-east-1b      |  192.168.128.0/19  |  subnet-04f3d465138687333  ||  us-east-1a      |  192.168.96.0/19   |  subnet-0bc4d31344c60c113  ||  us-east-1c      |  192.168.160.0/19  |  subnet-0bee6fc06187cafd1  |+------------------+--------------------+----------------------------+"><div></div></button></div></figure></div>
<p>Add mount targets for the subnets that your nodes are in.</p>
<p>Run the following command:</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">for</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3C63B3">subnet</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">in</span><span style="--0:#D6DEEB;--1:#403F53"> $(</span><span style="--0:#82AAFF;--1:#3C63B3">aws</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ec2</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">describe-subnets</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">--filters</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">Name=vpc-id,Values=</span><span style="--0:#C5E478;--1:#3C63B3">$vpc_id</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">--query</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">Subnets[*].{SubnetId: SubnetId,AvailabilityZone: AvailabilityZone,CidrBlock: CidrBlock}</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">--region</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3C63B3">$region</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">--output</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">text</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">awk</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">{print $3}</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#D6DEEB;--1:#403F53">) ; </span><span style="--0:#C792EA;--1:#8D46B4">do</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">aws</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">efs</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">create-mount-target</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">--file-system-id</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3C63B3">$file_system_id</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">--region</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3C63B3">$region</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">--subnet-id</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3C63B3">$subnet</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">--security-groups</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3C63B3">$security_group_id</span><span style="--0:#D6DEEB;--1:#403F53"> ; </span><span style="--0:#C792EA;--1:#8D46B4">done</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="for subnet in $(aws ec2 describe-subnets --filters &#x22;Name=vpc-id,Values=$vpc_id&#x22; --query &#x27;Subnets[*].{SubnetId: SubnetId,AvailabilityZone: AvailabilityZone,CidrBlock: CidrBlock}&#x27; --region $region --output text | awk &#x27;{print $3}&#x27;) ; do aws efs create-mount-target --file-system-id $file_system_id --region $region --subnet-id $subnet --security-groups $security_group_id ; done"><div></div></button></div></figure></div>
<p>This wraps the below command in a for loop that will iterate through your subnet ids.</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">aws efs create</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">mount</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">target \</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">file</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">system</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">id $file_system_id \</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">region $region \</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">subnet</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">id </span><span style="--0:#C792EA;--1:#8D46B4">&#x3C;</span><span style="--0:#82AAFF;--1:#3C63B3">SUBNETID</span><span style="--0:#C792EA;--1:#8D46B4">></span><span style="--0:#D6DEEB;--1:#403F53"> \</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">security</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">groups $security_group_id</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="aws efs create-mount-target \    --file-system-id $file_system_id \    --region $region \    --subnet-id <SUBNETID> \    --security-groups $security_group_id"><div></div></button></div></figure></div>
<h3 id="create-efs-storage-class">Create EFS Storage Class</h3>
<p>Create a storage class for dynamic provisioning</p>
<p>Let’s get our filesystem ID if we don’t already have it above. However if you ran the above steps, <code dir="auto">$file_system_id</code> should already be defined.</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">aws efs describe</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">file</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">systems \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">query </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">FileSystems[*].FileSystemId</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">region $region \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">output text</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">fs</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">071439ffb7e10b67b</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="aws efs describe-file-systems \--query &#x22;FileSystems[*].FileSystemId&#x22; \--region $region \--output textfs-071439ffb7e10b67b"><div></div></button></div></figure></div>

<aside aria-label="Super Important!" class="starlight-aside starlight-aside--note"><p class="starlight-aside__title" aria-hidden="true"><svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="starlight-aside__icon"><path d="M12 11C11.7348 11 11.4804 11.1054 11.2929 11.2929C11.1054 11.4804 11 11.7348 11 12V16C11 16.2652 11.1054 16.5196 11.2929 16.7071C11.4804 16.8946 11.7348 17 12 17C12.2652 17 12.5196 16.8946 12.7071 16.7071C12.8946 16.5196 13 16.2652 13 16V12C13 11.7348 12.8946 11.4804 12.7071 11.2929C12.5196 11.1054 12.2652 11 12 11ZM12.38 7.08C12.1365 6.97998 11.8635 6.97998 11.62 7.08C11.4973 7.12759 11.3851 7.19896 11.29 7.29C11.2017 7.3872 11.1306 7.49882 11.08 7.62C11.024 7.73868 10.9966 7.86882 11 8C10.9992 8.13161 11.0245 8.26207 11.0742 8.38391C11.124 8.50574 11.1973 8.61656 11.29 8.71C11.3872 8.79833 11.4988 8.86936 11.62 8.92C11.7715 8.98224 11.936 9.00632 12.099 8.99011C12.2619 8.97391 12.4184 8.91792 12.5547 8.82707C12.691 8.73622 12.8029 8.61328 12.8805 8.46907C12.9582 8.32486 12.9992 8.16378 13 8C12.9963 7.73523 12.8927 7.48163 12.71 7.29C12.6149 7.19896 12.5028 7.12759 12.38 7.08ZM12 2C10.0222 2 8.08879 2.58649 6.4443 3.6853C4.79981 4.78412 3.51809 6.3459 2.76121 8.17317C2.00433 10.0004 1.8063 12.0111 2.19215 13.9509C2.578 15.8907 3.53041 17.6725 4.92894 19.0711C6.32746 20.4696 8.10929 21.422 10.0491 21.8079C11.9889 22.1937 13.9996 21.9957 15.8268 21.2388C17.6541 20.4819 19.2159 19.2002 20.3147 17.5557C21.4135 15.9112 22 13.9778 22 12C22 10.6868 21.7413 9.38642 21.2388 8.17317C20.7363 6.95991 19.9997 5.85752 19.0711 4.92893C18.1425 4.00035 17.0401 3.26375 15.8268 2.7612C14.6136 2.25866 13.3132 2 12 2ZM12 20C10.4178 20 8.87104 19.5308 7.55544 18.6518C6.23985 17.7727 5.21447 16.5233 4.60897 15.0615C4.00347 13.5997 3.84504 11.9911 4.15372 10.4393C4.4624 8.88743 5.22433 7.46197 6.34315 6.34315C7.46197 5.22433 8.88743 4.4624 10.4393 4.15372C11.9911 3.84504 13.5997 4.00346 15.0615 4.60896C16.5233 5.21447 17.7727 6.23984 18.6518 7.55544C19.5308 8.87103 20 10.4177 20 12C20 14.1217 19.1572 16.1566 17.6569 17.6569C16.1566 19.1571 14.1217 20 12 20Z"></path></svg>Super Important!</p><section class="starlight-aside__content"><p>If you did not export the <code dir="auto">$file_system_id</code> variable, make sure the filesystem id you use in the below command is the filesystem id that was returned to you above!</p><p>Also if you are going to use EFS as your default storage, follow the instructions below. Otherwise just create the <code dir="auto">efs-sc</code> storage class and skip the <code dir="auto">efs-sc-pg</code> storage class as we will set the default to the gp3 block storage.</p></section></aside>
<p>Create the storage class</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">cat </span><span style="--0:#C792EA;--1:#8D46B4">&#x3C;&#x3C;</span><span style="--0:#82AAFF;--1:#3C63B3">EOF</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">|</span><span style="--0:#D6DEEB;--1:#403F53"> envsubst </span><span style="--0:#C792EA;--1:#8D46B4">|</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl apply </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">f </span><span style="--0:#C792EA;--1:#8D46B4">-</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">apiVersion: storage</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">k8s</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">io</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#D6DEEB;--1:#403F53">v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">kind: StorageClass</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">metadata:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">name: efs</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">sc</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">parameters:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">uid: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">0</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">gid: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">0</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">directoryPerms: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">777</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">fileSystemId: ${file_system_id}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">provisioningMode: efs</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">ap</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">provisioner: efs</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">csi</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">aws</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">com</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">reclaimPolicy: Delete</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">volumeBindingMode: Immediate</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">EOF</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="cat <<EOF | envsubst | kubectl apply -f -apiVersion: storage.k8s.io/v1kind: StorageClassmetadata:  name: efs-scparameters:  uid: &#x22;0&#x22;  gid: &#x22;0&#x22;  directoryPerms: &#x22;777&#x22;  fileSystemId: ${file_system_id}  provisioningMode: efs-approvisioner: efs.csi.aws.comreclaimPolicy: DeletevolumeBindingMode: ImmediateEOF"><div></div></button></div></figure></div>
<p>Create this second storageclasses for EFS for common-services operator that will be installed as part of IBM Foundational Services. You will only need this second storage class if you intend on using EFS instead of block storage.</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">cat </span><span style="--0:#C792EA;--1:#8D46B4">&#x3C;&#x3C;</span><span style="--0:#82AAFF;--1:#3C63B3">EOF</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">|</span><span style="--0:#D6DEEB;--1:#403F53"> envsubst </span><span style="--0:#C792EA;--1:#8D46B4">|</span><span style="--0:#D6DEEB;--1:#403F53"> kubectl apply </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">f </span><span style="--0:#C792EA;--1:#8D46B4">-</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">apiVersion: storage</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">k8s</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">io</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#D6DEEB;--1:#403F53">v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">kind: StorageClass</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">metadata:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">name: efs</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">sc</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">pg</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">parameters:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">uid: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">26</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">gid: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">65534</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">directoryPerms: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">777</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">fileSystemId: ${file_system_id}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">provisioningMode: efs</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">ap</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">provisioner: efs</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">csi</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">aws</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">com</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">reclaimPolicy: Delete</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">volumeBindingMode: Immediate</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">EOF</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="cat <<EOF | envsubst | kubectl apply -f -apiVersion: storage.k8s.io/v1kind: StorageClassmetadata:  name: efs-sc-pgparameters:  uid: &#x22;26&#x22;  gid: &#x22;65534&#x22;  directoryPerms: &#x22;777&#x22;  fileSystemId: ${file_system_id}  provisioningMode: efs-approvisioner: efs.csi.aws.comreclaimPolicy: DeletevolumeBindingMode: ImmediateEOF"><div></div></button></div></figure></div>


<aside aria-label="Setting Default Storage Class" class="starlight-aside starlight-aside--note"><p class="starlight-aside__title" aria-hidden="true"><svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="starlight-aside__icon"><path d="M12 11C11.7348 11 11.4804 11.1054 11.2929 11.2929C11.1054 11.4804 11 11.7348 11 12V16C11 16.2652 11.1054 16.5196 11.2929 16.7071C11.4804 16.8946 11.7348 17 12 17C12.2652 17 12.5196 16.8946 12.7071 16.7071C12.8946 16.5196 13 16.2652 13 16V12C13 11.7348 12.8946 11.4804 12.7071 11.2929C12.5196 11.1054 12.2652 11 12 11ZM12.38 7.08C12.1365 6.97998 11.8635 6.97998 11.62 7.08C11.4973 7.12759 11.3851 7.19896 11.29 7.29C11.2017 7.3872 11.1306 7.49882 11.08 7.62C11.024 7.73868 10.9966 7.86882 11 8C10.9992 8.13161 11.0245 8.26207 11.0742 8.38391C11.124 8.50574 11.1973 8.61656 11.29 8.71C11.3872 8.79833 11.4988 8.86936 11.62 8.92C11.7715 8.98224 11.936 9.00632 12.099 8.99011C12.2619 8.97391 12.4184 8.91792 12.5547 8.82707C12.691 8.73622 12.8029 8.61328 12.8805 8.46907C12.9582 8.32486 12.9992 8.16378 13 8C12.9963 7.73523 12.8927 7.48163 12.71 7.29C12.6149 7.19896 12.5028 7.12759 12.38 7.08ZM12 2C10.0222 2 8.08879 2.58649 6.4443 3.6853C4.79981 4.78412 3.51809 6.3459 2.76121 8.17317C2.00433 10.0004 1.8063 12.0111 2.19215 13.9509C2.578 15.8907 3.53041 17.6725 4.92894 19.0711C6.32746 20.4696 8.10929 21.422 10.0491 21.8079C11.9889 22.1937 13.9996 21.9957 15.8268 21.2388C17.6541 20.4819 19.2159 19.2002 20.3147 17.5557C21.4135 15.9112 22 13.9778 22 12C22 10.6868 21.7413 9.38642 21.2388 8.17317C20.7363 6.95991 19.9997 5.85752 19.0711 4.92893C18.1425 4.00035 17.0401 3.26375 15.8268 2.7612C14.6136 2.25866 13.3132 2 12 2ZM12 20C10.4178 20 8.87104 19.5308 7.55544 18.6518C6.23985 17.7727 5.21447 16.5233 4.60897 15.0615C4.00347 13.5997 3.84504 11.9911 4.15372 10.4393C4.4624 8.88743 5.22433 7.46197 6.34315 6.34315C7.46197 5.22433 8.88743 4.4624 10.4393 4.15372C11.9911 3.84504 13.5997 4.00346 15.0615 4.60896C16.5233 5.21447 17.7727 6.23984 18.6518 7.55544C19.5308 8.87103 20 10.4177 20 12C20 14.1217 19.1572 16.1566 17.6569 17.6569C16.1566 19.1571 14.1217 20 12 20Z"></path></svg>Setting Default Storage Class</p><section class="starlight-aside__content"><p>Set one of the EFS storage classes as the default storage class only if you intend on primarily using EFS. Otherwise set block storage as default.</p><p>If using EFS as primary storage</p><div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kubectl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">patch</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">storageclass</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">efs-sc</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-p</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">{"metadata": {"annotations":{"storageclass.kubernetes.io/is-default-class":"true"}}}</span><span style="--0:#D9F5DD;--1:#111111">'</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="kubectl patch storageclass efs-sc -p &#x27;{&#x22;metadata&#x22;: {&#x22;annotations&#x22;:{&#x22;storageclass.kubernetes.io/is-default-class&#x22;:&#x22;true&#x22;}}}&#x27;"><div></div></button></div></figure></div><p>If using EBS(block) as primary storage</p><div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kubectl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">patch</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">storageclass</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ebs-gp3-sc</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">-p</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">{"metadata": {"annotations":{"storageclass.kubernetes.io/is-default-class":"true"}}}</span><span style="--0:#D9F5DD;--1:#111111">'</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="kubectl patch storageclass ebs-gp3-sc -p &#x27;{&#x22;metadata&#x22;: {&#x22;annotations&#x22;:{&#x22;storageclass.kubernetes.io/is-default-class&#x22;:&#x22;true&#x22;}}}&#x27;"><div></div></button></div></figure></div></section></aside>
<p>Finally, verify they are both there</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">kubectl get sc</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">               </span><span style="--0:#82AAFF;--1:#3C63B3">PROVISIONER</span><span style="--0:#D6DEEB;--1:#403F53">             </span><span style="--0:#82AAFF;--1:#3C63B3">RECLAIMPOLICY</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#82AAFF;--1:#3C63B3">VOLUMEBINDINGMODE</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#82AAFF;--1:#3C63B3">ALLOWVOLUMEEXPANSION</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#82AAFF;--1:#3C63B3">AGE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">ebs</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">gp3</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">sc         ebs</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">csi</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">aws</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">com</span><span style="--0:#D6DEEB;--1:#403F53">         Delete          WaitForFirstConsumer   </span><span style="--0:#FF5874;--1:#A54A4A">false</span><span style="--0:#D6DEEB;--1:#403F53">                  6d18h</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">efs</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#82AAFF;--1:#3C63B3">sc</span><span style="--0:#D6DEEB;--1:#403F53"> (default)   efs</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">csi</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">aws</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">com</span><span style="--0:#D6DEEB;--1:#403F53">         Delete          Immediate              </span><span style="--0:#FF5874;--1:#A54A4A">false</span><span style="--0:#D6DEEB;--1:#403F53">                  16h</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">efs</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">sc</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">pg          efs</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">csi</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">aws</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">com</span><span style="--0:#D6DEEB;--1:#403F53">         Delete          Immediate              </span><span style="--0:#FF5874;--1:#A54A4A">false</span><span style="--0:#D6DEEB;--1:#403F53">                  14h</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">gp2                kubernetes</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">io</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#D6DEEB;--1:#403F53">aws</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">ebs   Delete          WaitForFirstConsumer   </span><span style="--0:#FF5874;--1:#A54A4A">false</span><span style="--0:#D6DEEB;--1:#403F53">                  6d23h</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="kubectl get scNAME               PROVISIONER             RECLAIMPOLICY   VOLUMEBINDINGMODE      ALLOWVOLUMEEXPANSION   AGEebs-gp3-sc         ebs.csi.aws.com         Delete          WaitForFirstConsumer   false                  6d18hefs-sc (default)   efs.csi.aws.com         Delete          Immediate              false                  16hefs-sc-pg          efs.csi.aws.com         Delete          Immediate              false                  14hgp2                kubernetes.io/aws-ebs   Delete          WaitForFirstConsumer   false                  6d23h"><div></div></button></div></figure></div>
<h3 id="verify-efs">Verify EFS</h3>
<p>Run the following command to create a pod and a PVC using the default EFS storage class</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">kubectl apply </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">f </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">&#x3C;&#x3C;</span><span style="--0:#82AAFF;--1:#3C63B3">EOF</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">apiVersion: v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">kind: PersistentVolumeClaim</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">metadata:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">name: block</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">pvc</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">spec:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">storageClassName: efs</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">sc</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">accessModes:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53"> ReadWriteOnce</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">resources:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">requests:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">      </span></span><span style="--0:#D6DEEB;--1:#403F53">storage: 1Gi</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#C792EA;--1:#8D46B4">-</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">apiVersion: v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">kind: Pod</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">metadata:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">name: mypod</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">spec:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">containers:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53"> name: myfrontend</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">      </span></span><span style="--0:#D6DEEB;--1:#403F53">image: nginx</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">      </span></span><span style="--0:#D6DEEB;--1:#403F53">volumeMounts:</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53"> mountPath: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">/var/www/html</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">          </span></span><span style="--0:#D6DEEB;--1:#403F53">name: mypd</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">volumes:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53"> name: mypd</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">      </span></span><span style="--0:#D6DEEB;--1:#403F53">persistentVolumeClaim:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">claimName: block</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">pvc</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">EOF</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="kubectl apply -f - <<EOFapiVersion: v1kind: PersistentVolumeClaimmetadata:  name: block-pvcspec:  storageClassName: efs-sc  accessModes:    - ReadWriteOnce  resources:    requests:      storage: 1Gi---apiVersion: v1kind: Podmetadata:  name: mypodspec:  containers:    - name: myfrontend      image: nginx      volumeMounts:        - mountPath: &#x22;/var/www/html&#x22;          name: mypd  volumes:    - name: mypd      persistentVolumeClaim:        claimName: block-pvcEOF"><div></div></button></div></figure></div>
<p>Running the following command should verify the PVC was successfully created and bound</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">kubectl get pvc</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="kubectl get pvc"><div></div></button></div></figure></div>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx[OUTPUT]"><code><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">NAME        STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS   VOLUMEATTRIBUTESCLASS   AGE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">block-pvc   Bound    pvc-dc711246-02a1-4a9d-b428-a2476b17dd8c   1Gi        RWO            efs-sc         &#x3C;unset>                 4s</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="NAME        STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS   VOLUMEATTRIBUTESCLASS   AGEblock-pvc   Bound    pvc-dc711246-02a1-4a9d-b428-a2476b17dd8c   1Gi        RWO            efs-sc         <unset>                 4s"><div></div></button></div></figure></div>
<p>Now we can delete our test pod and pvc</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">kubectl </span><span style="--0:#7FDBCA;--1:#097174">delete</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">f </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">&#x3C;&#x3C;</span><span style="--0:#82AAFF;--1:#3C63B3">EOF</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">apiVersion: v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">kind: PersistentVolumeClaim</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">metadata:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">name: block</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">pvc</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">spec:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">storageClassName: efs</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">sc</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">accessModes:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53"> ReadWriteOnce</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">resources:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">requests:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">      </span></span><span style="--0:#D6DEEB;--1:#403F53">storage: 1Gi</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#C792EA;--1:#8D46B4">-</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">apiVersion: v1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">kind: Pod</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">metadata:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">name: mypod</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">spec:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">containers:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53"> name: myfrontend</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">      </span></span><span style="--0:#D6DEEB;--1:#403F53">image: nginx</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">      </span></span><span style="--0:#D6DEEB;--1:#403F53">volumeMounts:</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53"> mountPath: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">/var/www/html</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">          </span></span><span style="--0:#D6DEEB;--1:#403F53">name: mypd</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">volumes:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53"> name: mypd</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">      </span></span><span style="--0:#D6DEEB;--1:#403F53">persistentVolumeClaim:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">claimName: block</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">pvc</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">EOF</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="kubectl delete -f - <<EOFapiVersion: v1kind: PersistentVolumeClaimmetadata:  name: block-pvcspec:  storageClassName: efs-sc  accessModes:    - ReadWriteOnce  resources:    requests:      storage: 1Gi---apiVersion: v1kind: Podmetadata:  name: mypodspec:  containers:    - name: myfrontend      image: nginx      volumeMounts:        - mountPath: &#x22;/var/www/html&#x22;          name: mypd  volumes:    - name: mypd      persistentVolumeClaim:        claimName: block-pvcEOF"><div></div></button></div></figure></div>
<h2 id="install-nginx-controller">Install NGINX Controller</h2>
<aside aria-label="On Ingresses" class="starlight-aside starlight-aside--note"><p class="starlight-aside__title" aria-hidden="true"><svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="starlight-aside__icon"><path d="M12 11C11.7348 11 11.4804 11.1054 11.2929 11.2929C11.1054 11.4804 11 11.7348 11 12V16C11 16.2652 11.1054 16.5196 11.2929 16.7071C11.4804 16.8946 11.7348 17 12 17C12.2652 17 12.5196 16.8946 12.7071 16.7071C12.8946 16.5196 13 16.2652 13 16V12C13 11.7348 12.8946 11.4804 12.7071 11.2929C12.5196 11.1054 12.2652 11 12 11ZM12.38 7.08C12.1365 6.97998 11.8635 6.97998 11.62 7.08C11.4973 7.12759 11.3851 7.19896 11.29 7.29C11.2017 7.3872 11.1306 7.49882 11.08 7.62C11.024 7.73868 10.9966 7.86882 11 8C10.9992 8.13161 11.0245 8.26207 11.0742 8.38391C11.124 8.50574 11.1973 8.61656 11.29 8.71C11.3872 8.79833 11.4988 8.86936 11.62 8.92C11.7715 8.98224 11.936 9.00632 12.099 8.99011C12.2619 8.97391 12.4184 8.91792 12.5547 8.82707C12.691 8.73622 12.8029 8.61328 12.8805 8.46907C12.9582 8.32486 12.9992 8.16378 13 8C12.9963 7.73523 12.8927 7.48163 12.71 7.29C12.6149 7.19896 12.5028 7.12759 12.38 7.08ZM12 2C10.0222 2 8.08879 2.58649 6.4443 3.6853C4.79981 4.78412 3.51809 6.3459 2.76121 8.17317C2.00433 10.0004 1.8063 12.0111 2.19215 13.9509C2.578 15.8907 3.53041 17.6725 4.92894 19.0711C6.32746 20.4696 8.10929 21.422 10.0491 21.8079C11.9889 22.1937 13.9996 21.9957 15.8268 21.2388C17.6541 20.4819 19.2159 19.2002 20.3147 17.5557C21.4135 15.9112 22 13.9778 22 12C22 10.6868 21.7413 9.38642 21.2388 8.17317C20.7363 6.95991 19.9997 5.85752 19.0711 4.92893C18.1425 4.00035 17.0401 3.26375 15.8268 2.7612C14.6136 2.25866 13.3132 2 12 2ZM12 20C10.4178 20 8.87104 19.5308 7.55544 18.6518C6.23985 17.7727 5.21447 16.5233 4.60897 15.0615C4.00347 13.5997 3.84504 11.9911 4.15372 10.4393C4.4624 8.88743 5.22433 7.46197 6.34315 6.34315C7.46197 5.22433 8.88743 4.4624 10.4393 4.15372C11.9911 3.84504 13.5997 4.00346 15.0615 4.60896C16.5233 5.21447 17.7727 6.23984 18.6518 7.55544C19.5308 8.87103 20 10.4177 20 12C20 14.1217 19.1572 16.1566 17.6569 17.6569C16.1566 19.1571 14.1217 20 12 20Z"></path></svg>On Ingresses</p><section class="starlight-aside__content"><p>If you plan on using AWS ALB for ingress, follow the directions <a href="../04_optional_services/#optional-install-the-alb-ingress-controller">here</a></p></section></aside>
<p>Let’s install the NGINX helm chart</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">helm repo add ingress</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">nginx https:</span><span style="--0:#809191;--1:#5E6578">//kubernetes.github.io/ingress-nginx</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">helm repo update</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="helm repo add ingress-nginx https://kubernetes.github.io/ingress-nginxhelm repo update"><div></div></button></div></figure></div>

<p>Create the namespace for NGINX</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">kubectl create ns ingress</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">nginx</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="kubectl create ns ingress-nginx"><div></div></button></div></figure></div>
<p>Export our relevant subnet ids to a comma delimited env variable</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">export</span><span style="--0:#D6DEEB;--1:#403F53"> subnets</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#82AAFF;--1:#3C63B3">$</span><span style="--0:#D6DEEB;--1:#403F53">(aws eks describe</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">cluster </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">name ${clustername} </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">region ${region} </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">query </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">cluster.resourcesVpcConfig.subnetIds</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">output json </span><span style="--0:#C792EA;--1:#8D46B4">|</span><span style="--0:#D6DEEB;--1:#403F53"> jq </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">r </span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">join(",")</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">|</span><span style="--0:#D6DEEB;--1:#403F53"> sed s</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#D6DEEB;--1:#403F53">,</span><span style="--0:#D9F5DD;--1:#111111">/</span><span style="--0:#F78C6C;--1:#AA0982">\\\\</span><span style="--0:#5CA7E4;--1:#3A6A90">,</span><span style="--0:#D9F5DD;--1:#111111">/</span><span style="--0:#5CA7E4;--1:#3A6A90">g</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="export subnets=$(aws eks describe-cluster --name ${clustername} --region ${region} --query &#x22;cluster.resourcesVpcConfig.subnetIds&#x22; --output json | jq -r &#x27;join(&#x22;,&#x22;)&#x27; | sed s/,/\\\\,/g)"><div></div></button></div></figure></div>
<p>Now install the helm chart for nginx</p>

<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">helm install ingress</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">nginx ingress</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">nginx</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#D6DEEB;--1:#403F53">ingress</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">nginx \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">set</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">string controller</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">service</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">annotations</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">service</span><span style="--0:#F78C6C;--1:#AA0982">\.</span><span style="--0:#ECC48D;--1:#9B504E">beta</span><span style="--0:#F78C6C;--1:#AA0982">\.</span><span style="--0:#ECC48D;--1:#9B504E">kubernetes</span><span style="--0:#F78C6C;--1:#AA0982">\.</span><span style="--0:#ECC48D;--1:#9B504E">io/aws-load-balancer-backend-protocol</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53">tcp \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">set</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">string controller</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">service</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">annotations</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">service</span><span style="--0:#F78C6C;--1:#AA0982">\.</span><span style="--0:#ECC48D;--1:#9B504E">beta</span><span style="--0:#F78C6C;--1:#AA0982">\.</span><span style="--0:#ECC48D;--1:#9B504E">kubernetes</span><span style="--0:#F78C6C;--1:#AA0982">\.</span><span style="--0:#ECC48D;--1:#9B504E">io/aws-load-balancer-cross-zone-load-balancing-enabled</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">true</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">set</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">string controller</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">service</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">annotations</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">service</span><span style="--0:#F78C6C;--1:#AA0982">\.</span><span style="--0:#ECC48D;--1:#9B504E">beta</span><span style="--0:#F78C6C;--1:#AA0982">\.</span><span style="--0:#ECC48D;--1:#9B504E">kubernetes</span><span style="--0:#F78C6C;--1:#AA0982">\.</span><span style="--0:#ECC48D;--1:#9B504E">io/aws-load-balancer-type</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53">nlb \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">namespace</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53">ingress</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">nginx</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="helm install ingress-nginx ingress-nginx/ingress-nginx \--set-string controller.service.annotations.&#x27;service\.beta\.kubernetes\.io/aws-load-balancer-backend-protocol&#x27;=tcp \--set-string controller.service.annotations.&#x27;service\.beta\.kubernetes\.io/aws-load-balancer-cross-zone-load-balancing-enabled&#x27;=&#x22;true&#x22; \--set-string controller.service.annotations.&#x27;service\.beta\.kubernetes\.io/aws-load-balancer-type&#x27;=nlb \--namespace=ingress-nginx"><div></div></button></div></figure></div>
<p>Run the following command to verify that a load balancer was assigned</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">kubectl get service </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#C792EA;--1:#8D46B4">namespace</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#FFCB8B;--1:#111111">ingress</span><span style="--0:#D6DEEB;--1:#403F53">-</span><span style="--0:#FFCB8B;--1:#111111">nginx</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#FFCB8B;--1:#111111">ingress</span><span style="--0:#D6DEEB;--1:#403F53">-</span><span style="--0:#FFCB8B;--1:#111111">nginx</span><span style="--0:#D6DEEB;--1:#403F53">-</span><span style="--0:#FFCB8B;--1:#111111">controller</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="kubectl get service --namespace ingress-nginx ingress-nginx-controller"><div></div></button></div></figure></div>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx[OUTPUT]"><code><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">NAME                       TYPE           CLUSTER-IP       EXTERNAL-IP                                                                     PORT(S)                      AGE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">ingress-nginx-controller   LoadBalancer   10.100.204.215   a904f47d90a8c4961ae389b155359368-aa0f265b8588c710.elb.us-east-1.amazonaws.com   80:30870/TCP,443:31883/TCP   61s</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="NAME                       TYPE           CLUSTER-IP       EXTERNAL-IP                                                                     PORT(S)                      AGEingress-nginx-controller   LoadBalancer   10.100.204.215   a904f47d90a8c4961ae389b155359368-aa0f265b8588c710.elb.us-east-1.amazonaws.com   80:30870/TCP,443:31883/TCP   61s"><div></div></button></div></figure></div>

<h3 id="verify-the-nginx-deployment">Verify the NGINX deployment</h3>
<p>Verify the deployment</p>
<p>Command:</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">kubectl</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">get</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">ingressclass</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="kubectl get ingressclass"><div></div></button></div></figure></div>
<p>Example output:</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#82AAFF;--1:#3C63B3">CONTROLLER</span><span style="--0:#D6DEEB;--1:#403F53">             </span><span style="--0:#82AAFF;--1:#3C63B3">PARAMETERS</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#82AAFF;--1:#3C63B3">AGE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">nginx   k8s</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">io</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#D6DEEB;--1:#403F53">ingress</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">nginx   </span><span style="--0:#C792EA;--1:#8D46B4">&#x3C;</span><span style="--0:#D6DEEB;--1:#403F53">none</span><span style="--0:#C792EA;--1:#8D46B4">></span><span style="--0:#D6DEEB;--1:#403F53">       2m43s</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="NAME    CONTROLLER             PARAMETERS   AGEnginx   k8s.io/ingress-nginx   <none>       2m43s"><div></div></button></div></figure></div>

<h2 id="install-the-operator-lifecycle-manager">Install the Operator Lifecycle Manager</h2>
<p>Run the following command using the <code dir="auto">operator-sdk</code></p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">operator</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">sdk olm install</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="operator-sdk olm install"><div></div></button></div></figure></div>
<p>Verify the installation</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">kubectl get csv </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">n olm </span><span style="--0:#C792EA;--1:#8D46B4">|</span><span style="--0:#D6DEEB;--1:#403F53"> grep packageserver</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="kubectl get csv -n olm | grep packageserver"><div></div></button></div></figure></div>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx[OUTPUT]"><code><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">packageserver   Package Server   0.28.0               Succeeded</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="packageserver   Package Server   0.28.0               Succeeded"><div></div></button></div></figure></div>
<p>Set the OLM global namespade to use openshift-marketplace</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">oc set env deploy</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#D6DEEB;--1:#403F53">catalog</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">operator </span><span style="--0:#82AAFF;--1:#3C63B3">GLOBAL_CATALOG_NAMESPACE</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53">openshift</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">marketplace </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">n olm</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="oc set env deploy/catalog-operator GLOBAL_CATALOG_NAMESPACE=openshift-marketplace -n olm"><div></div></button></div></figure></div>
<p>We further require to change the global namespace for the packageserver as well. To do so, run the following command:</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">kubectl patch csv packageserver </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">n olm </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">type</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">json</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">p</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#FFFFFF;--1:#9B504E">[</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">op</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">replace</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">path</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">/spec/install/spec/deployments/0/spec/template/spec/containers/0/command/5</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">value</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">openshift-marketplace</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#D9F5DD;--1:#111111">'</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="kubectl patch csv packageserver -n olm --type=&#x27;json&#x27; -p=&#x27;[  {    &#x22;op&#x22;: &#x22;replace&#x22;,    &#x22;path&#x22;: &#x22;/spec/install/spec/deployments/0/spec/template/spec/containers/0/command/5&#x22;,    &#x22;value&#x22;: &#x22;openshift-marketplace&#x22;  }]&#x27;"><div></div></button></div></figure></div>
<p>Verify the global-namespace has been set</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">kubectl get deploy packageserver </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">n olm </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">o yaml </span><span style="--0:#C792EA;--1:#8D46B4">|</span><span style="--0:#D6DEEB;--1:#403F53"> grep </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#82AAFF;--1:#3C63B3">A</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">6</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">command:</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="kubectl get deploy packageserver -n olm -o yaml | grep -A 6 &#x22;command:&#x22;"><div></div></button></div></figure></div>
<p>Should return</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53"> command:</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#D6DEEB;--1:#403F53">bin</span><span style="--0:#C792EA;--1:#8D46B4">/package-</span><span style="--0:#D6DEEB;--1:#403F53">server</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">v</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">4</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">secure</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">port</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">5443</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">global</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">namespace</span></div></div><div class="ec-line highlight mark"><div class="code"><span class="indent">        </span><span style="--0:#C792EA;--1:#773b98">-</span><span style="--0:#D6DEEB;--1:#403F53"> openshift</span><span style="--0:#C792EA;--1:#773b98">-</span><span style="--0:#D6DEEB;--1:#403F53">marketplace</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="      - command:        - /bin/package-server        - -v=4        - --secure-port        - &#x22;5443&#x22;        - --global-namespace        - openshift-marketplace"><div></div></button></div></figure></div>
<h2 id="create-the-required-namespace">Create the required Namespace</h2>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">kubectl create ns openshift</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">marketplace</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="kubectl create ns openshift-marketplace"><div></div></button></div></figure></div>
<p>Set our context to that namespace and export it as an env var</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">export</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">NAMESPACE</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53">openshift</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">marketplace</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">kubectl config set</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">context </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">current </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#C792EA;--1:#8D46B4">namespace</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#FFCB8B;--1:#111111">$NAMESPACE</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="export NAMESPACE=openshift-marketplacekubectl config set-context --current --namespace $NAMESPACE"><div></div></button></div></figure></div>
<h2 id="install-the-ibm-cert-manager">Install the IBM Cert Manager</h2>
<p>If you followed the directions <a href="../01_pre-reqs/#downloading-the-case-file">here</a> you should have the <code dir="auto">ibm-guardium-insights</code> case file downloaded and extracted.</p>
<p>Change to the following directory</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">cd ibm</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">guardium</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">insights</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#D6DEEB;--1:#403F53">inventory</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#D6DEEB;--1:#403F53">install</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#D6DEEB;--1:#403F53">files</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#D6DEEB;--1:#403F53">support</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#D6DEEB;--1:#403F53">eks</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="cd ibm-guardium-insights/inventory/install/files/support/eks"><div></div></button></div></figure></div>
<p>Create the namespace and then run the installation script</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">kubectl create </span><span style="--0:#C792EA;--1:#8D46B4">namespace</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#FFCB8B;--1:#111111">ibm</span><span style="--0:#D6DEEB;--1:#403F53">-</span><span style="--0:#FFCB8B;--1:#111111">cert</span><span style="--0:#D6DEEB;--1:#403F53">-</span><span style="--0:#FFCB8B;--1:#111111">manager</span></div></div><div class="ec-line"><div class="code"><span style="--0:#FFCB8B;--1:#111111">chmod</span><span style="--0:#D6DEEB;--1:#403F53"> +</span><span style="--0:#FFCB8B;--1:#111111">x</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#FFCB8B;--1:#111111">ibm</span><span style="--0:#D6DEEB;--1:#403F53">-</span><span style="--0:#FFCB8B;--1:#111111">cert</span><span style="--0:#D6DEEB;--1:#403F53">-</span><span style="--0:#FFCB8B;--1:#111111">manager</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FFCB8B;--1:#111111">sh</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#D6DEEB;--1:#403F53">/</span><span style="--0:#FFCB8B;--1:#111111">ibm</span><span style="--0:#D6DEEB;--1:#403F53">-</span><span style="--0:#FFCB8B;--1:#111111">cert</span><span style="--0:#D6DEEB;--1:#403F53">-</span><span style="--0:#FFCB8B;--1:#111111">manager</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FFCB8B;--1:#111111">sh</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="kubectl create namespace ibm-cert-managerchmod +x ibm-cert-manager.sh./ibm-cert-manager.sh"><div></div></button></div></figure></div>

<p>Give it a few minutes and then verify the cert manager is up</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">kubectl get po </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">n ibm</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">cert</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">manager</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="kubectl get po -n ibm-cert-manager"><div></div></button></div></figure></div>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">                                                              </span><span style="--0:#82AAFF;--1:#3C63B3">READY</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#82AAFF;--1:#3C63B3">STATUS</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#82AAFF;--1:#3C63B3">RESTARTS</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#82AAFF;--1:#3C63B3">AGE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">cd6e1c2b84458a4f431f49f499a919d28af0b23693e36f2fc53bc1f2c3hw5pw   </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">     Completed   </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">          2m1s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">cert</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">manager</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">cainjector</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">85777f77cc</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">hbzg7                          </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">     Running     </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">          102s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">cert</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">manager</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">controller</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">957bc947</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">kg5wx                            </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">     Running     </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">          102s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">cert</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">manager</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">webhook</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">5586d798f</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">lcsln                              </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">     Running     </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">          102s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">ibm</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">cert</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">manager</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">catalog</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">rcbvc                                    </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">     Running     </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">          2m12s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">ibm</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">cert</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">manager</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">operator</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">64fc5b4644</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">rnpqg                        </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">     Running     </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">          108s</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="NAME                                                              READY   STATUS      RESTARTS   AGEcd6e1c2b84458a4f431f49f499a919d28af0b23693e36f2fc53bc1f2c3hw5pw   0/1     Completed   0          2m1scert-manager-cainjector-85777f77cc-hbzg7                          1/1     Running     0          102scert-manager-controller-957bc947-kg5wx                            1/1     Running     0          102scert-manager-webhook-5586d798f-lcsln                              1/1     Running     0          102sibm-cert-manager-catalog-rcbvc                                    1/1     Running     0          2m12sibm-cert-manager-operator-64fc5b4644-rnpqg                        1/1     Running     0          108s"><div></div></button></div></figure></div>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">kubectl get csv </span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">n ibm</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">cert</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">manager</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="kubectl get csv -n ibm-cert-manager"><div></div></button></div></figure></div>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="plaintext"><code><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">NAME                               DISPLAY            VERSION   REPLACES   PHASE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">ibm-cert-manager-operator.v4.2.7   IBM Cert Manager   4.2.7                Succeeded</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="NAME                               DISPLAY            VERSION   REPLACES   PHASEibm-cert-manager-operator.v4.2.7   IBM Cert Manager   4.2.7                Succeeded"><div></div></button></div></figure></div>
<aside aria-label="Deploying with ACM" class="starlight-aside starlight-aside--note"><p class="starlight-aside__title" aria-hidden="true"><svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="starlight-aside__icon"><path d="M12 11C11.7348 11 11.4804 11.1054 11.2929 11.2929C11.1054 11.4804 11 11.7348 11 12V16C11 16.2652 11.1054 16.5196 11.2929 16.7071C11.4804 16.8946 11.7348 17 12 17C12.2652 17 12.5196 16.8946 12.7071 16.7071C12.8946 16.5196 13 16.2652 13 16V12C13 11.7348 12.8946 11.4804 12.7071 11.2929C12.5196 11.1054 12.2652 11 12 11ZM12.38 7.08C12.1365 6.97998 11.8635 6.97998 11.62 7.08C11.4973 7.12759 11.3851 7.19896 11.29 7.29C11.2017 7.3872 11.1306 7.49882 11.08 7.62C11.024 7.73868 10.9966 7.86882 11 8C10.9992 8.13161 11.0245 8.26207 11.0742 8.38391C11.124 8.50574 11.1973 8.61656 11.29 8.71C11.3872 8.79833 11.4988 8.86936 11.62 8.92C11.7715 8.98224 11.936 9.00632 12.099 8.99011C12.2619 8.97391 12.4184 8.91792 12.5547 8.82707C12.691 8.73622 12.8029 8.61328 12.8805 8.46907C12.9582 8.32486 12.9992 8.16378 13 8C12.9963 7.73523 12.8927 7.48163 12.71 7.29C12.6149 7.19896 12.5028 7.12759 12.38 7.08ZM12 2C10.0222 2 8.08879 2.58649 6.4443 3.6853C4.79981 4.78412 3.51809 6.3459 2.76121 8.17317C2.00433 10.0004 1.8063 12.0111 2.19215 13.9509C2.578 15.8907 3.53041 17.6725 4.92894 19.0711C6.32746 20.4696 8.10929 21.422 10.0491 21.8079C11.9889 22.1937 13.9996 21.9957 15.8268 21.2388C17.6541 20.4819 19.2159 19.2002 20.3147 17.5557C21.4135 15.9112 22 13.9778 22 12C22 10.6868 21.7413 9.38642 21.2388 8.17317C20.7363 6.95991 19.9997 5.85752 19.0711 4.92893C18.1425 4.00035 17.0401 3.26375 15.8268 2.7612C14.6136 2.25866 13.3132 2 12 2ZM12 20C10.4178 20 8.87104 19.5308 7.55544 18.6518C6.23985 17.7727 5.21447 16.5233 4.60897 15.0615C4.00347 13.5997 3.84504 11.9911 4.15372 10.4393C4.4624 8.88743 5.22433 7.46197 6.34315 6.34315C7.46197 5.22433 8.88743 4.4624 10.4393 4.15372C11.9911 3.84504 13.5997 4.00346 15.0615 4.60896C16.5233 5.21447 17.7727 6.23984 18.6518 7.55544C19.5308 8.87103 20 10.4177 20 12C20 14.1217 19.1572 16.1566 17.6569 17.6569C16.1566 19.1571 14.1217 20 12 20Z"></path></svg>Deploying with ACM</p><section class="starlight-aside__content"><p>If you plan to use AWS ACM to manage your certs with an ALB ingress, follow the install instructions <a href="../04_optional_services/#use-aws-ca-acm-for-certs-optional">here</a></p></section></aside>
<h2 id="configure-dns-resolution-optional">Configure DNS resolution (Optional)</h2>
<p>If you are following the instrutions in this guide using the “insecure” hostname sections to avoid
registering domains, it’s possible to use Route 53 in AWS set up explicit DNS resolution for the
specific host routes needed.</p>
<p>Go to <a href="https://console.aws.amazon.com/route53/">AWS Route 53</a> and click <code dir="auto">Hosted zones</code> heading.
Then click the <code dir="auto">Create hosted zone</code> button. This will open the hosted zone form.</p>
<p>For the domain use</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="plaintext"><code><div class="ec-line"><div class="code"><span style="--0:#d6deeb;--1:#403f53">apps.gi.guardium-insights.com</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="apps.gi.guardium-insights.com"><div></div></button></div></figure></div>
<p>For type, select <code dir="auto">Private hosted zone</code></p>
<p><img src="https://media.github.ibm.com/user/207188/files/764833c5-2f7e-4f0c-8415-aed7390c465e" alt="image"></p>
<p>For the VPCs to associate with the hosted zone, select the proper region, then select the VPC that was created for your cluster.</p>
<p><img src="https://media.github.ibm.com/user/207188/files/27cbf581-9648-449d-952d-9eea350785ee" alt="image"></p>
<p>Then click <code dir="auto">Create Hosted zone</code> button to create the hosted zone.</p>
<p>This will take you to the hosted zone details page. Now it’s time to create some records for DNS resolution.
But first we need the values to use for the internal routing.</p>
<p>Find the private cluster IP address of the load balancer under <code dir="auto">CLUSTER-IP</code>.</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">kubectl get service </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#C792EA;--1:#8D46B4">namespace</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#FFCB8B;--1:#111111">ingress</span><span style="--0:#D6DEEB;--1:#403F53">-</span><span style="--0:#FFCB8B;--1:#111111">nginx</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#FFCB8B;--1:#111111">ingress</span><span style="--0:#D6DEEB;--1:#403F53">-</span><span style="--0:#FFCB8B;--1:#111111">nginx</span><span style="--0:#D6DEEB;--1:#403F53">-</span><span style="--0:#FFCB8B;--1:#111111">controller</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="kubectl get service --namespace ingress-nginx ingress-nginx-controller"><div></div></button></div></figure></div>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">                       </span><span style="--0:#82AAFF;--1:#3C63B3">TYPE</span><span style="--0:#D6DEEB;--1:#403F53">           </span><span style="--0:#82AAFF;--1:#3C63B3">CLUSTER</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#82AAFF;--1:#3C63B3">IP</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#82AAFF;--1:#3C63B3">EXTERNAL</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#82AAFF;--1:#3C63B3">IP</span><span style="--0:#D6DEEB;--1:#403F53">                                                                     </span><span style="--0:#82AAFF;--1:#3C63B3">PORT</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#82AAFF;--1:#3C63B3">S</span><span style="--0:#D6DEEB;--1:#403F53">)                      </span><span style="--0:#82AAFF;--1:#3C63B3">AGE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">ingress</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">nginx</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">controller   LoadBalancer   </span><span style="--0:#F78C6C;--1:#AA0982">10.100</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#F78C6C;--1:#AA0982">24.243</span><span style="--0:#D6DEEB;--1:#403F53">   a091398910dbf4ad8aeb2f3f0e864311</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">916cbf853e32c1d5</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">elb</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">us</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">east</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">2</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">amazonaws</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">com</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">80</span><span style="--0:#D6DEEB;--1:#403F53">:</span><span style="--0:#F78C6C;--1:#AA0982">31369</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#82AAFF;--1:#3C63B3">TCP</span><span style="--0:#D6DEEB;--1:#403F53">,</span><span style="--0:#F78C6C;--1:#AA0982">443</span><span style="--0:#D6DEEB;--1:#403F53">:</span><span style="--0:#F78C6C;--1:#AA0982">30370</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#82AAFF;--1:#3C63B3">TCP</span><span style="--0:#D6DEEB;--1:#403F53">   20h</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="NAME                       TYPE           CLUSTER-IP      EXTERNAL-IP                                                                     PORT(S)                      AGEingress-nginx-controller   LoadBalancer   10.100.24.243   a091398910dbf4ad8aeb2f3f0e864311-916cbf853e32c1d5.elb.us-east-2.amazonaws.com   80:31369/TCP,443:30370/TCP   20h"><div></div></button></div></figure></div>
<p>Capture that <code dir="auto">CLUSTER-IP</code> value for the next steps.</p>
<p>Back on the hosted zone details page, click the <code dir="auto">Create record</code> button.</p>
<p>We want to create a record that routes <code dir="auto">cp-console-openshift-marketplace.apps.gi.guardium-insights.com</code> to
the private IP address captured above.</p>
<p><img src="https://media.github.ibm.com/user/207188/files/fbb0bb48-1795-4fbb-af74-c068ecb562b2" alt="image"></p>
<p>Click <code dir="auto">Create Records</code>.</p>
<h2 id="install-foundational-services">Install Foundational Services</h2>
<aside aria-label="Entitlement" class="starlight-aside starlight-aside--note"><p class="starlight-aside__title" aria-hidden="true"><svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="starlight-aside__icon"><path d="M12 11C11.7348 11 11.4804 11.1054 11.2929 11.2929C11.1054 11.4804 11 11.7348 11 12V16C11 16.2652 11.1054 16.5196 11.2929 16.7071C11.4804 16.8946 11.7348 17 12 17C12.2652 17 12.5196 16.8946 12.7071 16.7071C12.8946 16.5196 13 16.2652 13 16V12C13 11.7348 12.8946 11.4804 12.7071 11.2929C12.5196 11.1054 12.2652 11 12 11ZM12.38 7.08C12.1365 6.97998 11.8635 6.97998 11.62 7.08C11.4973 7.12759 11.3851 7.19896 11.29 7.29C11.2017 7.3872 11.1306 7.49882 11.08 7.62C11.024 7.73868 10.9966 7.86882 11 8C10.9992 8.13161 11.0245 8.26207 11.0742 8.38391C11.124 8.50574 11.1973 8.61656 11.29 8.71C11.3872 8.79833 11.4988 8.86936 11.62 8.92C11.7715 8.98224 11.936 9.00632 12.099 8.99011C12.2619 8.97391 12.4184 8.91792 12.5547 8.82707C12.691 8.73622 12.8029 8.61328 12.8805 8.46907C12.9582 8.32486 12.9992 8.16378 13 8C12.9963 7.73523 12.8927 7.48163 12.71 7.29C12.6149 7.19896 12.5028 7.12759 12.38 7.08ZM12 2C10.0222 2 8.08879 2.58649 6.4443 3.6853C4.79981 4.78412 3.51809 6.3459 2.76121 8.17317C2.00433 10.0004 1.8063 12.0111 2.19215 13.9509C2.578 15.8907 3.53041 17.6725 4.92894 19.0711C6.32746 20.4696 8.10929 21.422 10.0491 21.8079C11.9889 22.1937 13.9996 21.9957 15.8268 21.2388C17.6541 20.4819 19.2159 19.2002 20.3147 17.5557C21.4135 15.9112 22 13.9778 22 12C22 10.6868 21.7413 9.38642 21.2388 8.17317C20.7363 6.95991 19.9997 5.85752 19.0711 4.92893C18.1425 4.00035 17.0401 3.26375 15.8268 2.7612C14.6136 2.25866 13.3132 2 12 2ZM12 20C10.4178 20 8.87104 19.5308 7.55544 18.6518C6.23985 17.7727 5.21447 16.5233 4.60897 15.0615C4.00347 13.5997 3.84504 11.9911 4.15372 10.4393C4.4624 8.88743 5.22433 7.46197 6.34315 6.34315C7.46197 5.22433 8.88743 4.4624 10.4393 4.15372C11.9911 3.84504 13.5997 4.00346 15.0615 4.60896C16.5233 5.21447 17.7727 6.23984 18.6518 7.55544C19.5308 8.87103 20 10.4177 20 12C20 14.1217 19.1572 16.1566 17.6569 17.6569C16.1566 19.1571 14.1217 20 12 20Z"></path></svg>Entitlement</p><section class="starlight-aside__content"><p>As noted <a href="../guardium_insights/01_pre-reqs/">here</a> make sure you have retrieved your entitlement key and applied it to the namespace</p><p>Export your entitlement key as an env var</p><div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">export</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">IBMKEY</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">&#x3C;entitlement key></span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="export IBMKEY=&#x22;<entitlement key>&#x22;"><div></div></button></div></figure></div><p>Set the entitlement key</p><div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">kubectl create secret docker</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">registry ibm</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">entitlement</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">key \</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">docker</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">username</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53">cp \</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">docker</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">password</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53">${</span><span style="--0:#82AAFF;--1:#3C63B3">IBMKEY</span><span style="--0:#D6DEEB;--1:#403F53">} \</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">docker</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">server</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53">cp</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">icr</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">io</span><span style="--0:#D6DEEB;--1:#403F53"> \</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">namespace</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53">${</span><span style="--0:#82AAFF;--1:#3C63B3">NAMESPACE</span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="kubectl create secret docker-registry ibm-entitlement-key \    --docker-username=cp \    --docker-password=${IBMKEY} \    --docker-server=cp.icr.io \    --namespace=${NAMESPACE}"><div></div></button></div></figure></div></section></aside>
<p>Change to the following directory</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">cd ibm</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">guardium</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">insights</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#D6DEEB;--1:#403F53">inventory</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#D6DEEB;--1:#403F53">install</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#D6DEEB;--1:#403F53">files</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#D6DEEB;--1:#403F53">support</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#D6DEEB;--1:#403F53">eks</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="cd ibm-guardium-insights/inventory/install/files/support/eks"><div></div></button></div></figure></div>
<p>As of this writing, we are using Guardium Insights v3.5.0 which uses bundle version 2.5.0.</p>
<p>Export the following vars</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">export</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">REPLACE_NAMESPACE</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53">openshift</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">marketplace</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">export</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">NAMESPACE</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53">openshift</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">marketplace</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">export</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">ICS_INVENTORY_SETUP</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53">ibmCommonServiceOperatorSetup</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">export</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">ICS_SIZE</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53">starterset</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">export</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">IBMPAK_LAUNCH_SKIP_PREREQ_CHECK</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#FF5874;--1:#A54A4A">true</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">export</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">CP_REPO_USER</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">cp</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">export</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">CP_REPO_PASS</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53">${</span><span style="--0:#82AAFF;--1:#3C63B3">IBMKEY</span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">export</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">NAMESPACE</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">openshift-marketplace</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">export</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">CASE_NAME</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53">ibm</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">guardium</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">insights</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">export</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">CASE_VERSION</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#F78C6C;--1:#AA0982">2.5</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#F78C6C;--1:#AA0982">0</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">export</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">LOCAL_CASE_DIR</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53">$HOME</span><span style="--0:#C792EA;--1:#8D46B4">/.</span><span style="--0:#7FDBCA;--1:#097174">ibm</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">pak</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#D6DEEB;--1:#403F53">data</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#D6DEEB;--1:#403F53">cases</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#D6DEEB;--1:#403F53">$CASE_NAME</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#D6DEEB;--1:#403F53">$CASE_VERSION</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="export REPLACE_NAMESPACE=openshift-marketplaceexport NAMESPACE=openshift-marketplaceexport ICS_INVENTORY_SETUP=ibmCommonServiceOperatorSetupexport ICS_SIZE=startersetexport IBMPAK_LAUNCH_SKIP_PREREQ_CHECK=trueexport CP_REPO_USER=&#x22;cp&#x22;export CP_REPO_PASS=${IBMKEY}export NAMESPACE=&#x22;openshift-marketplace&#x22;export CASE_NAME=ibm-guardium-insightsexport CASE_VERSION=2.5.0export LOCAL_CASE_DIR=$HOME/.ibm-pak/data/cases/$CASE_NAME/$CASE_VERSION"><div></div></button></div></figure></div>
<p>Save the CASE bundle locally</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">oc ibm</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">pak get $CASE_NAME \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">version $CASE_VERSION \</span></div></div><div class="ec-line"><div class="code"><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">skip</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">verify</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="oc ibm-pak get $CASE_NAME \--version $CASE_VERSION \--skip-verify"><div></div></button></div></figure></div>
<p>This will download the CASE bundle to <code dir="auto">$HOME/.ibm-pak/data/cases/ibm-guardium-insights/2.5.0</code></p>

<aside aria-label="On DNS" class="starlight-aside starlight-aside--note"><p class="starlight-aside__title" aria-hidden="true"><svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="starlight-aside__icon"><path d="M12 11C11.7348 11 11.4804 11.1054 11.2929 11.2929C11.1054 11.4804 11 11.7348 11 12V16C11 16.2652 11.1054 16.5196 11.2929 16.7071C11.4804 16.8946 11.7348 17 12 17C12.2652 17 12.5196 16.8946 12.7071 16.7071C12.8946 16.5196 13 16.2652 13 16V12C13 11.7348 12.8946 11.4804 12.7071 11.2929C12.5196 11.1054 12.2652 11 12 11ZM12.38 7.08C12.1365 6.97998 11.8635 6.97998 11.62 7.08C11.4973 7.12759 11.3851 7.19896 11.29 7.29C11.2017 7.3872 11.1306 7.49882 11.08 7.62C11.024 7.73868 10.9966 7.86882 11 8C10.9992 8.13161 11.0245 8.26207 11.0742 8.38391C11.124 8.50574 11.1973 8.61656 11.29 8.71C11.3872 8.79833 11.4988 8.86936 11.62 8.92C11.7715 8.98224 11.936 9.00632 12.099 8.99011C12.2619 8.97391 12.4184 8.91792 12.5547 8.82707C12.691 8.73622 12.8029 8.61328 12.8805 8.46907C12.9582 8.32486 12.9992 8.16378 13 8C12.9963 7.73523 12.8927 7.48163 12.71 7.29C12.6149 7.19896 12.5028 7.12759 12.38 7.08ZM12 2C10.0222 2 8.08879 2.58649 6.4443 3.6853C4.79981 4.78412 3.51809 6.3459 2.76121 8.17317C2.00433 10.0004 1.8063 12.0111 2.19215 13.9509C2.578 15.8907 3.53041 17.6725 4.92894 19.0711C6.32746 20.4696 8.10929 21.422 10.0491 21.8079C11.9889 22.1937 13.9996 21.9957 15.8268 21.2388C17.6541 20.4819 19.2159 19.2002 20.3147 17.5557C21.4135 15.9112 22 13.9778 22 12C22 10.6868 21.7413 9.38642 21.2388 8.17317C20.7363 6.95991 19.9997 5.85752 19.0711 4.92893C18.1425 4.00035 17.0401 3.26375 15.8268 2.7612C14.6136 2.25866 13.3132 2 12 2ZM12 20C10.4178 20 8.87104 19.5308 7.55544 18.6518C6.23985 17.7727 5.21447 16.5233 4.60897 15.0615C4.00347 13.5997 3.84504 11.9911 4.15372 10.4393C4.4624 8.88743 5.22433 7.46197 6.34315 6.34315C7.46197 5.22433 8.88743 4.4624 10.4393 4.15372C11.9911 3.84504 13.5997 4.00346 15.0615 4.60896C16.5233 5.21447 17.7727 6.23984 18.6518 7.55544C19.5308 8.87103 20 10.4177 20 12C20 14.1217 19.1572 16.1566 17.6569 17.6569C16.1566 19.1571 14.1217 20 12 20Z"></path></svg>On DNS</p><section class="starlight-aside__content"><p>Whether you’re using Route 53 or external DNS, a CNAME must be created if you’re using NGINX as your Ingress Controller.</p><p>For our example setup, we are working with the <code dir="auto">thinkforward.work</code> domain. So we set the domain in our remote dns to <code dir="auto">apps.gi.thinkforward.work</code>. Other users may need to configure their FQDN in AWS Route 53.</p><p>The important part is there must be a wildcard subdomain. It should point to our loadbalancer.</p><p>Retrieve the loadbalancer ip with this command:</p><div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">kubectl get service </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#C792EA;--1:#8D46B4">namespace</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#FFCB8B;--1:#111111">ingress</span><span style="--0:#D6DEEB;--1:#403F53">-</span><span style="--0:#FFCB8B;--1:#111111">nginx</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#FFCB8B;--1:#111111">ingress</span><span style="--0:#D6DEEB;--1:#403F53">-</span><span style="--0:#FFCB8B;--1:#111111">nginx</span><span style="--0:#D6DEEB;--1:#403F53">-</span><span style="--0:#FFCB8B;--1:#111111">controller</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="kubectl get service --namespace ingress-nginx ingress-nginx-controller"><div></div></button></div></figure></div><p>Should return</p><div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">                       </span><span style="--0:#82AAFF;--1:#3C63B3">TYPE</span><span style="--0:#D6DEEB;--1:#403F53">           </span><span style="--0:#82AAFF;--1:#3C63B3">CLUSTER</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#82AAFF;--1:#3C63B3">IP</span><span style="--0:#D6DEEB;--1:#403F53">       </span><span style="--0:#82AAFF;--1:#3C63B3">EXTERNAL</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#82AAFF;--1:#3C63B3">IP</span><span style="--0:#D6DEEB;--1:#403F53">                                                                     </span><span style="--0:#82AAFF;--1:#3C63B3">PORT</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#82AAFF;--1:#3C63B3">S</span><span style="--0:#D6DEEB;--1:#403F53">)                      </span><span style="--0:#82AAFF;--1:#3C63B3">AGE</span></div></div><div class="ec-line highlight mark"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">ingress</span><span style="--0:#C792EA;--1:#773b98">-</span><span style="--0:#D6DEEB;--1:#403F53">nginx</span><span style="--0:#C792EA;--1:#773b98">-</span><span style="--0:#D6DEEB;--1:#403F53">controller   LoadBalancer   </span><span style="--0:#F78C6C;--1:#a2097c">10.100</span><span style="--0:#C792EA;--1:#773b98">.</span><span style="--0:#F78C6C;--1:#a2097c">129.192</span><span style="--0:#D6DEEB;--1:#403F53">   k8s</span><span style="--0:#C792EA;--1:#773b98">-</span><span style="--0:#D6DEEB;--1:#403F53">ingressn</span><span style="--0:#C792EA;--1:#773b98">-</span><span style="--0:#D6DEEB;--1:#403F53">ingressn</span><span style="--0:#C792EA;--1:#773b98">-</span><span style="--0:#D6DEEB;--1:#403F53">7e06ec0c6b</span><span style="--0:#C792EA;--1:#773b98">-</span><span style="--0:#D6DEEB;--1:#403F53">01363c775f8b7ff9</span><span style="--0:#C792EA;--1:#773b98">.</span><span style="--0:#FAF39F;--1:#111111">elb</span><span style="--0:#C792EA;--1:#773b98">.</span><span style="--0:#7FDBCA;--1:#086164">us</span><span style="--0:#C792EA;--1:#773b98">-</span><span style="--0:#D6DEEB;--1:#403F53">east</span><span style="--0:#C792EA;--1:#773b98">-</span><span style="--0:#D6DEEB;--1:#403F53">1</span><span style="--0:#C792EA;--1:#773b98">.</span><span style="--0:#FAF39F;--1:#111111">amazonaws</span><span style="--0:#C792EA;--1:#773b98">.</span><span style="--0:#7FDBCA;--1:#086164">com</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#a2097c">80</span><span style="--0:#D6DEEB;--1:#403F53">:</span><span style="--0:#F78C6C;--1:#a2097c">32113</span><span style="--0:#C792EA;--1:#773b98">/</span><span style="--0:#82AAFF;--1:#335497">TCP</span><span style="--0:#D6DEEB;--1:#403F53">,</span><span style="--0:#F78C6C;--1:#a2097c">443</span><span style="--0:#D6DEEB;--1:#403F53">:</span><span style="--0:#F78C6C;--1:#a2097c">31457</span><span style="--0:#C792EA;--1:#773b98">/</span><span style="--0:#82AAFF;--1:#335497">TCP</span><span style="--0:#D6DEEB;--1:#403F53">   24h</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="NAME                       TYPE           CLUSTER-IP       EXTERNAL-IP                                                                     PORT(S)                      AGEingress-nginx-controller   LoadBalancer   10.100.129.192   k8s-ingressn-ingressn-7e06ec0c6b-01363c775f8b7ff9.elb.us-east-1.amazonaws.com   80:32113/TCP,443:31457/TCP   24h"><div></div></button></div></figure></div><p>Our external IP above is <code dir="auto">k8s-ingressn-ingressn-7e06ec0c6b-01363c775f8b7ff9.elb.us-east-1.amazonaws.com</code></p><p>So for us, our actual DNS record should be like this:</p><div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">CNAME</span><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#C792EA;--1:#8D46B4">*.</span><span style="--0:#7FDBCA;--1:#097174">gi</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">east</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">apps</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">thinkforward</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">work</span><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#C792EA;--1:#8D46B4">-></span><span style="--0:#D6DEEB;--1:#403F53">  k8s</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">ingressn</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">ingressn</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">7e06ec0c6b</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">01363c775f8b7ff9</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">elb</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">us</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">east</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">1</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">amazonaws</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">com</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="CNAME    *.gi-east.apps.thinkforward.work  ->  k8s-ingressn-ingressn-7e06ec0c6b-01363c775f8b7ff9.elb.us-east-1.amazonaws.com"><div></div></button></div></figure></div><p>The <code dir="auto">*</code> wildcard ensures that any subdomain generated by GI will map back to that loadbalancer.</p></section></aside>
<p>Export the hostname as an env var. It’s important to note that your domain must begin with <code dir="auto">apps</code>. If you have multiple clusters, a good practices would be <code dir="auto">apps.&#x3C;CLUSTERNAME>.&#x3C;DOMAIN></code>.</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">export</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">HOSTNAME</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53">apps</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">gi</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">thinkforward</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">work</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="export HOSTNAME=apps.gi.thinkforward.work"><div></div></button></div></figure></div>
<aside aria-label="Using an insecure hostname" class="starlight-aside starlight-aside--note"><p class="starlight-aside__title" aria-hidden="true"><svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="starlight-aside__icon"><path d="M12 11C11.7348 11 11.4804 11.1054 11.2929 11.2929C11.1054 11.4804 11 11.7348 11 12V16C11 16.2652 11.1054 16.5196 11.2929 16.7071C11.4804 16.8946 11.7348 17 12 17C12.2652 17 12.5196 16.8946 12.7071 16.7071C12.8946 16.5196 13 16.2652 13 16V12C13 11.7348 12.8946 11.4804 12.7071 11.2929C12.5196 11.1054 12.2652 11 12 11ZM12.38 7.08C12.1365 6.97998 11.8635 6.97998 11.62 7.08C11.4973 7.12759 11.3851 7.19896 11.29 7.29C11.2017 7.3872 11.1306 7.49882 11.08 7.62C11.024 7.73868 10.9966 7.86882 11 8C10.9992 8.13161 11.0245 8.26207 11.0742 8.38391C11.124 8.50574 11.1973 8.61656 11.29 8.71C11.3872 8.79833 11.4988 8.86936 11.62 8.92C11.7715 8.98224 11.936 9.00632 12.099 8.99011C12.2619 8.97391 12.4184 8.91792 12.5547 8.82707C12.691 8.73622 12.8029 8.61328 12.8805 8.46907C12.9582 8.32486 12.9992 8.16378 13 8C12.9963 7.73523 12.8927 7.48163 12.71 7.29C12.6149 7.19896 12.5028 7.12759 12.38 7.08ZM12 2C10.0222 2 8.08879 2.58649 6.4443 3.6853C4.79981 4.78412 3.51809 6.3459 2.76121 8.17317C2.00433 10.0004 1.8063 12.0111 2.19215 13.9509C2.578 15.8907 3.53041 17.6725 4.92894 19.0711C6.32746 20.4696 8.10929 21.422 10.0491 21.8079C11.9889 22.1937 13.9996 21.9957 15.8268 21.2388C17.6541 20.4819 19.2159 19.2002 20.3147 17.5557C21.4135 15.9112 22 13.9778 22 12C22 10.6868 21.7413 9.38642 21.2388 8.17317C20.7363 6.95991 19.9997 5.85752 19.0711 4.92893C18.1425 4.00035 17.0401 3.26375 15.8268 2.7612C14.6136 2.25866 13.3132 2 12 2ZM12 20C10.4178 20 8.87104 19.5308 7.55544 18.6518C6.23985 17.7727 5.21447 16.5233 4.60897 15.0615C4.00347 13.5997 3.84504 11.9911 4.15372 10.4393C4.4624 8.88743 5.22433 7.46197 6.34315 6.34315C7.46197 5.22433 8.88743 4.4624 10.4393 4.15372C11.9911 3.84504 13.5997 4.00346 15.0615 4.60896C16.5233 5.21447 17.7727 6.23984 18.6518 7.55544C19.5308 8.87103 20 10.4177 20 12C20 14.1217 19.1572 16.1566 17.6569 17.6569C16.1566 19.1571 14.1217 20 12 20Z"></path></svg>Using an insecure hostname</p><section class="starlight-aside__content"><p>For development purposes only, you can avoid registering a domain name and setting up certificates
by using your local <code dir="auto">hosts</code> file to redirect traffic later in this guide. If taking this route, you can use the following:</p><div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8D46B4">export</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">HOSTNAME</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53">apps</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">gi</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">guardium</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">insights</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">com</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="export HOSTNAME=apps.gi.guardium-insights.com"><div></div></button></div></figure></div></section></aside>

<p>Run the following <code dir="auto">ibm-pak</code> command to install the Foundational Services catalogs</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">oc ibm</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">pak launch $CASE_NAME \</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">version $CASE_VERSION \</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">action install</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">catalog \</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">inventory $ICS_INVENTORY_SETUP \</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#C792EA;--1:#8D46B4">namespace</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#FFCB8B;--1:#111111">$NAMESPACE</span><span style="--0:#D6DEEB;--1:#403F53"> \</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">   </span></span><span style="--0:#D6DEEB;--1:#403F53">--</span><span style="--0:#FFCB8B;--1:#111111">args</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">--registry icr.io --recursive --inputDir ${LOCAL_CASE_DIR}</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="oc ibm-pak launch $CASE_NAME \   --version $CASE_VERSION \   --action install-catalog \   --inventory $ICS_INVENTORY_SETUP \   --namespace $NAMESPACE \   --args &#x22;--registry icr.io --recursive --inputDir ${LOCAL_CASE_DIR}&#x22;"><div></div></button></div></figure></div>

<p>Now run the following <code dir="auto">ibm-pak</code> command to install the Foundational Services operators</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">oc ibm</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">pak launch $CASE_NAME \</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">version $CASE_VERSION \</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">action install</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">operator \</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#D6DEEB;--1:#403F53">inventory $ICS_INVENTORY_SETUP \</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#C792EA;--1:#8D46B4">namespace</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#FFCB8B;--1:#111111">$NAMESPACE</span><span style="--0:#D6DEEB;--1:#403F53"> \</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">   </span></span><span style="--0:#D6DEEB;--1:#403F53">--</span><span style="--0:#FFCB8B;--1:#111111">args</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">--size ${ICS_SIZE} --ks_flag true --hostname ${HOSTNAME} --registry cp.icr.io --user ${CP_REPO_USER} --pass ${CP_REPO_PASS} --secret ibm-entitlement-key --recursive --inputDir ${LOCAL_CASE_DIR}</span><span style="--0:#D9F5DD;--1:#111111">"</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="oc ibm-pak launch $CASE_NAME \   --version $CASE_VERSION \   --action install-operator \   --inventory $ICS_INVENTORY_SETUP \   --namespace $NAMESPACE \   --args &#x22;--size ${ICS_SIZE} --ks_flag true --hostname ${HOSTNAME} --registry cp.icr.io --user ${CP_REPO_USER} --pass ${CP_REPO_PASS} --secret ibm-entitlement-key --recursive --inputDir ${LOCAL_CASE_DIR}&#x22;"><div></div></button></div></figure></div>
<p>This may take a little while to run.</p>


<h3 id="verify-foundational-services-are-properly-installed">Verify Foundational Services are properly installed</h3>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">kubectl get csv </span><span style="--0:#C792EA;--1:#8D46B4">|</span><span style="--0:#D6DEEB;--1:#403F53"> grep ibm</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="kubectl get csv | grep ibm"><div></div></button></div></figure></div>
<p>Output should look like this:</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">ibm</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">cert</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">manager</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">operator</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">v4</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#F78C6C;--1:#AA0982">2.9</span><span style="--0:#D6DEEB;--1:#403F53">              </span><span style="--0:#82AAFF;--1:#3C63B3">IBM</span><span style="--0:#D6DEEB;--1:#403F53"> Cert Manager                       </span><span style="--0:#F78C6C;--1:#AA0982">4.2</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#F78C6C;--1:#AA0982">9</span><span style="--0:#D6DEEB;--1:#403F53">                                        Succeeded</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">ibm</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">common</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">service</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">operator</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">v4</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#F78C6C;--1:#AA0982">6.5</span><span style="--0:#D6DEEB;--1:#403F53">            </span><span style="--0:#82AAFF;--1:#3C63B3">IBM</span><span style="--0:#D6DEEB;--1:#403F53"> Cloud Pak foundational services    </span><span style="--0:#F78C6C;--1:#AA0982">4.6</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#F78C6C;--1:#AA0982">5</span><span style="--0:#D6DEEB;--1:#403F53">                                        Succeeded</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">ibm</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">commonui</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">operator</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">v4</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#F78C6C;--1:#AA0982">4.4</span><span style="--0:#D6DEEB;--1:#403F53">                  Ibm Common </span><span style="--0:#82AAFF;--1:#3C63B3">UI</span><span style="--0:#D6DEEB;--1:#403F53">                          </span><span style="--0:#F78C6C;--1:#AA0982">4.4</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#F78C6C;--1:#AA0982">4</span><span style="--0:#D6DEEB;--1:#403F53">                                        Succeeded</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">ibm</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">events</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">operator</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">v5</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#F78C6C;--1:#AA0982">0.1</span><span style="--0:#D6DEEB;--1:#403F53">                    </span><span style="--0:#82AAFF;--1:#3C63B3">IBM</span><span style="--0:#D6DEEB;--1:#403F53"> Events Operator                    </span><span style="--0:#F78C6C;--1:#AA0982">5.0</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">                                        Succeeded</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">ibm</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">iam</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">operator</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">v4</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#F78C6C;--1:#AA0982">5.4</span><span style="--0:#D6DEEB;--1:#403F53">                       </span><span style="--0:#82AAFF;--1:#3C63B3">IBM</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">IM</span><span style="--0:#D6DEEB;--1:#403F53"> Operator                        </span><span style="--0:#F78C6C;--1:#AA0982">4.5</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#F78C6C;--1:#AA0982">4</span><span style="--0:#D6DEEB;--1:#403F53">                                        Succeeded</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">ibm</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">zen</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">operator</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">v5</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#F78C6C;--1:#AA0982">1.7</span><span style="--0:#D6DEEB;--1:#403F53">                       </span><span style="--0:#82AAFF;--1:#3C63B3">IBM</span><span style="--0:#D6DEEB;--1:#403F53"> Zen Service                        </span><span style="--0:#F78C6C;--1:#AA0982">5.1</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#F78C6C;--1:#AA0982">7</span><span style="--0:#D6DEEB;--1:#403F53">                                        Succeeded</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="ibm-cert-manager-operator.v4.2.9              IBM Cert Manager                       4.2.9                                        Succeededibm-common-service-operator.v4.6.5            IBM Cloud Pak foundational services    4.6.5                                        Succeededibm-commonui-operator.v4.4.4                  Ibm Common UI                          4.4.4                                        Succeededibm-events-operator.v5.0.1                    IBM Events Operator                    5.0.1                                        Succeededibm-iam-operator.v4.5.4                       IBM IM Operator                        4.5.4                                        Succeededibm-zen-operator.v5.1.7                       IBM Zen Service                        5.1.7                                        Succeeded"><div></div></button></div></figure></div>
<h3 id="verify-that-the-operand-requests-have-completed-and-installed">Verify that the operand requests have completed and installed</h3>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">kubectl get opreq</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="kubectl get opreq"><div></div></button></div></figure></div>
<p>Output should look like this:</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">                          </span><span style="--0:#82AAFF;--1:#3C63B3">AGE</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#82AAFF;--1:#3C63B3">PHASE</span><span style="--0:#D6DEEB;--1:#403F53">     </span><span style="--0:#82AAFF;--1:#3C63B3">CREATED</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">AT</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">common</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">service                4m41s   Running   </span><span style="--0:#F78C6C;--1:#AA0982">2024</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#F78C6C;--1:#AA0982">10</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">14T20:</span><span style="--0:#F78C6C;--1:#AA0982">21</span><span style="--0:#D6DEEB;--1:#403F53">:04</span><span style="--0:#82AAFF;--1:#3C63B3">Z</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">ibm</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">iam</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">request               4m9s    Running   </span><span style="--0:#F78C6C;--1:#AA0982">2024</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#F78C6C;--1:#AA0982">10</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">14T20:</span><span style="--0:#F78C6C;--1:#AA0982">21</span><span style="--0:#D6DEEB;--1:#403F53">:36</span><span style="--0:#82AAFF;--1:#3C63B3">Z</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">postgresql</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">operator</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">request   4m8s    Running   </span><span style="--0:#F78C6C;--1:#AA0982">2024</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#F78C6C;--1:#AA0982">10</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">14T20:</span><span style="--0:#F78C6C;--1:#AA0982">21</span><span style="--0:#D6DEEB;--1:#403F53">:37</span><span style="--0:#82AAFF;--1:#3C63B3">Z</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="NAME                          AGE     PHASE     CREATED ATcommon-service                4m41s   Running   2024-10-14T20:21:04Zibm-iam-request               4m9s    Running   2024-10-14T20:21:36Zpostgresql-operator-request   4m8s    Running   2024-10-14T20:21:37Z"><div></div></button></div></figure></div>

<p>Verify the policies have all been created</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">kubectl get netpol</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="kubectl get netpol"><div></div></button></div></figure></div>
<p>Output should look like this:</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">                                     </span><span style="--0:#82AAFF;--1:#3C63B3">POD</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#82AAFF;--1:#3C63B3">SELECTOR</span><span style="--0:#D6DEEB;--1:#403F53">                                     </span><span style="--0:#82AAFF;--1:#3C63B3">AGE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">access</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">to</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">audit</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">svc                      component</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53">zen</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">audit                              4m1s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">access</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">to</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">common</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">web</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">ui                  k8s</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">app</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53">common</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">web</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">ui                            4m19s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">access</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">to</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">edb</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">postgres                   k8s</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">enterprisedb</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">io</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#D6DEEB;--1:#403F53">cluster                      4m16s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">access</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">to</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">edb</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">postgres</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">webhooks          app</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">kubernetes</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">io</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#D6DEEB;--1:#403F53">name</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53">cloud</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">native</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">postgresql   3m30s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">access</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">to</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">ibm</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">common</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">service</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">operator    name</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53">ibm</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">common</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">service</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">operator                 3m27s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">access</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">to</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">ibm</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">nginx                      component</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53">ibm</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">nginx                              3m58s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">access</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">to</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">icp</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">mongodb                    app</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53">icp</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">mongodb                                  4m13s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">access</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">to</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">platform</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">auth</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">service          k8s</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">app</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53">platform</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">auth</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">service                    4m10s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">access</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">to</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">platform</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">identity</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">management   k8s</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">app</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53">platform</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">identity</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">management             4m5s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">access</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">to</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">platform</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">identity</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">provider     k8s</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">app</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53">platform</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">identity</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">provider               4m3s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">access</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">to</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">usermgmt                       component</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53">usermgmt                               3m55s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">access</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">to</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">volumes                        icpdsupport</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#D6DEEB;--1:#403F53">app</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53">volumes                          3m42s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">access</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">to</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">zen</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">core                       component</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53">zen</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">core                               3m50s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">access</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">to</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">zen</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">core</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">api                   component</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53">zen</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">core</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">api                           3m52s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">access</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">to</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">zen</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">meta</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">api                   app</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">kubernetes</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">io</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#D6DEEB;--1:#403F53">instance</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53">ibm</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">zen</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">meta</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">api      3m24s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">access</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">to</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">zen</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">minio                      component</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53">zen</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">minio                              3m46s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">access</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">to</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">zen</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">watchdog                   component</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53">zen</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">watchdog                           3m39s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">allow</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">iam</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">config</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">job                     component</span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53">iam</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">config</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">job                         3m34s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">allow</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">webhook</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">access</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">from</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">apiserver      </span><span style="--0:#C792EA;--1:#8D46B4">&#x3C;</span><span style="--0:#D6DEEB;--1:#403F53">none</span><span style="--0:#C792EA;--1:#8D46B4">></span><span style="--0:#D6DEEB;--1:#403F53">                                           3m21s</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="NAME                                     POD-SELECTOR                                     AGEaccess-to-audit-svc                      component=zen-audit                              4m1saccess-to-common-web-ui                  k8s-app=common-web-ui                            4m19saccess-to-edb-postgres                   k8s.enterprisedb.io/cluster                      4m16saccess-to-edb-postgres-webhooks          app.kubernetes.io/name=cloud-native-postgresql   3m30saccess-to-ibm-common-service-operator    name=ibm-common-service-operator                 3m27saccess-to-ibm-nginx                      component=ibm-nginx                              3m58saccess-to-icp-mongodb                    app=icp-mongodb                                  4m13saccess-to-platform-auth-service          k8s-app=platform-auth-service                    4m10saccess-to-platform-identity-management   k8s-app=platform-identity-management             4m5saccess-to-platform-identity-provider     k8s-app=platform-identity-provider               4m3saccess-to-usermgmt                       component=usermgmt                               3m55saccess-to-volumes                        icpdsupport/app=volumes                          3m42saccess-to-zen-core                       component=zen-core                               3m50saccess-to-zen-core-api                   component=zen-core-api                           3m52saccess-to-zen-meta-api                   app.kubernetes.io/instance=ibm-zen-meta-api      3m24saccess-to-zen-minio                      component=zen-minio                              3m46saccess-to-zen-watchdog                   component=zen-watchdog                           3m39sallow-iam-config-job                     component=iam-config-job                         3m34sallow-webhook-access-from-apiserver      <none>                                           3m21s"><div></div></button></div></figure></div>
<p>Verify NGINX ingresses have been created</p>

<p>Verify the ingress creation</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">kubectl get ingress</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="kubectl get ingress"><div></div></button></div></figure></div>
<p>Output should look like this:</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">                         </span><span style="--0:#82AAFF;--1:#3C63B3">CLASS</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#82AAFF;--1:#3C63B3">HOSTS</span><span style="--0:#D6DEEB;--1:#403F53">                                                         </span><span style="--0:#82AAFF;--1:#3C63B3">ADDRESS</span><span style="--0:#D6DEEB;--1:#403F53">                                                                               </span><span style="--0:#82AAFF;--1:#3C63B3">PORTS</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#82AAFF;--1:#3C63B3">AGE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">cncf</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">common</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">web</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">ui           nginx   cp</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">console</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">openshift</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">marketplace</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">apps</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">gi</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">thinkforward</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">work</span><span style="--0:#D6DEEB;--1:#403F53">    k8s</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">ingressn</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">ingressn</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">7e06ec0c6b</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">01363c775f8b7ff9</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">elb</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">us</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">east</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">1</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">amazonaws</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">com</span><span style="--0:#D6DEEB;--1:#403F53">         </span><span style="--0:#F78C6C;--1:#AA0982">80</span><span style="--0:#D6DEEB;--1:#403F53">      13s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">cncf</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">id</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">mgmt                 nginx   cp</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">console</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">openshift</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">marketplace</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">apps</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">gi</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">thinkforward</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">work</span><span style="--0:#D6DEEB;--1:#403F53">    k8s</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">ingressn</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">ingressn</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">7e06ec0c6b</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">01363c775f8b7ff9</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">elb</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">us</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">east</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">1</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">amazonaws</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">com</span><span style="--0:#D6DEEB;--1:#403F53">         </span><span style="--0:#F78C6C;--1:#AA0982">80</span><span style="--0:#D6DEEB;--1:#403F53">      13s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">cncf</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">platform</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">auth           nginx   cp</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">console</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">openshift</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">marketplace</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">apps</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">gi</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">thinkforward</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">work</span><span style="--0:#D6DEEB;--1:#403F53">    k8s</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">ingressn</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">ingressn</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">7e06ec0c6b</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">01363c775f8b7ff9</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">elb</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">us</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">east</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">1</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">amazonaws</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">com</span><span style="--0:#D6DEEB;--1:#403F53">         </span><span style="--0:#F78C6C;--1:#AA0982">80</span><span style="--0:#D6DEEB;--1:#403F53">      13s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">cncf</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">platform</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">id</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">auth        nginx   cp</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">console</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">openshift</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">marketplace</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">apps</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">gi</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">thinkforward</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">work</span><span style="--0:#D6DEEB;--1:#403F53">    k8s</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">ingressn</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">ingressn</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">7e06ec0c6b</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">01363c775f8b7ff9</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">elb</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">us</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">east</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">1</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">amazonaws</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">com</span><span style="--0:#D6DEEB;--1:#403F53">         </span><span style="--0:#F78C6C;--1:#AA0982">80</span><span style="--0:#D6DEEB;--1:#403F53">      13s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">cncf</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">platform</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">id</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">provider    nginx   cp</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">console</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">openshift</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">marketplace</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">apps</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">gi</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">thinkforward</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">work</span><span style="--0:#D6DEEB;--1:#403F53">    k8s</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">ingressn</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">ingressn</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">7e06ec0c6b</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">01363c775f8b7ff9</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">elb</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">us</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">east</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">1</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">amazonaws</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">com</span><span style="--0:#D6DEEB;--1:#403F53">         </span><span style="--0:#F78C6C;--1:#AA0982">80</span><span style="--0:#D6DEEB;--1:#403F53">      13s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">cncf</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">platform</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">login          nginx   cp</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">console</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">openshift</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">marketplace</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">apps</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">gi</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">thinkforward</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">work</span><span style="--0:#D6DEEB;--1:#403F53">    k8s</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">ingressn</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">ingressn</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">7e06ec0c6b</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">01363c775f8b7ff9</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">elb</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">us</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">east</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">1</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">amazonaws</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">com</span><span style="--0:#D6DEEB;--1:#403F53">         </span><span style="--0:#F78C6C;--1:#AA0982">80</span><span style="--0:#D6DEEB;--1:#403F53">      13s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">cncf</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">platform</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">oidc           nginx   cp</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">console</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">openshift</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">marketplace</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">apps</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">gi</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">thinkforward</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">work</span><span style="--0:#D6DEEB;--1:#403F53">    k8s</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">ingressn</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">ingressn</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">7e06ec0c6b</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">01363c775f8b7ff9</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">elb</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">us</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">east</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">1</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">amazonaws</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">com</span><span style="--0:#D6DEEB;--1:#403F53">         </span><span style="--0:#F78C6C;--1:#AA0982">80</span><span style="--0:#D6DEEB;--1:#403F53">      13s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">cncf</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">saml</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">ui</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">callback        nginx   cp</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">console</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">openshift</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">marketplace</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">apps</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">gi</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">thinkforward</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">work</span><span style="--0:#D6DEEB;--1:#403F53">    k8s</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">ingressn</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">ingressn</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">7e06ec0c6b</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">01363c775f8b7ff9</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">elb</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">us</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">east</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">1</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">amazonaws</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">com</span><span style="--0:#D6DEEB;--1:#403F53">         </span><span style="--0:#F78C6C;--1:#AA0982">80</span><span style="--0:#D6DEEB;--1:#403F53">      13s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">cncf</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">social</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">login</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">callback   nginx   cp</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">console</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">openshift</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">marketplace</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">apps</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">gi</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">thinkforward</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">work</span><span style="--0:#D6DEEB;--1:#403F53">    k8s</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">ingressn</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">ingressn</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">7e06ec0c6b</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">01363c775f8b7ff9</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">elb</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">us</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">east</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">1</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">amazonaws</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">com</span><span style="--0:#D6DEEB;--1:#403F53">         </span><span style="--0:#F78C6C;--1:#AA0982">80</span><span style="--0:#D6DEEB;--1:#403F53">      13s</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="NAME                         CLASS   HOSTS                                                         ADDRESS                                                                               PORTS   AGEcncf-common-web-ui           nginx   cp-console-openshift-marketplace.apps.gi.thinkforward.work    k8s-ingressn-ingressn-7e06ec0c6b-01363c775f8b7ff9.elb.us-east-1.amazonaws.com         80      13scncf-id-mgmt                 nginx   cp-console-openshift-marketplace.apps.gi.thinkforward.work    k8s-ingressn-ingressn-7e06ec0c6b-01363c775f8b7ff9.elb.us-east-1.amazonaws.com         80      13scncf-platform-auth           nginx   cp-console-openshift-marketplace.apps.gi.thinkforward.work    k8s-ingressn-ingressn-7e06ec0c6b-01363c775f8b7ff9.elb.us-east-1.amazonaws.com         80      13scncf-platform-id-auth        nginx   cp-console-openshift-marketplace.apps.gi.thinkforward.work    k8s-ingressn-ingressn-7e06ec0c6b-01363c775f8b7ff9.elb.us-east-1.amazonaws.com         80      13scncf-platform-id-provider    nginx   cp-console-openshift-marketplace.apps.gi.thinkforward.work    k8s-ingressn-ingressn-7e06ec0c6b-01363c775f8b7ff9.elb.us-east-1.amazonaws.com         80      13scncf-platform-login          nginx   cp-console-openshift-marketplace.apps.gi.thinkforward.work    k8s-ingressn-ingressn-7e06ec0c6b-01363c775f8b7ff9.elb.us-east-1.amazonaws.com         80      13scncf-platform-oidc           nginx   cp-console-openshift-marketplace.apps.gi.thinkforward.work    k8s-ingressn-ingressn-7e06ec0c6b-01363c775f8b7ff9.elb.us-east-1.amazonaws.com         80      13scncf-saml-ui-callback        nginx   cp-console-openshift-marketplace.apps.gi.thinkforward.work    k8s-ingressn-ingressn-7e06ec0c6b-01363c775f8b7ff9.elb.us-east-1.amazonaws.com         80      13scncf-social-login-callback   nginx   cp-console-openshift-marketplace.apps.gi.thinkforward.work    k8s-ingressn-ingressn-7e06ec0c6b-01363c775f8b7ff9.elb.us-east-1.amazonaws.com         80      13s"><div></div></button></div></figure></div>
<aside aria-label="Using an insecure hostname" class="starlight-aside starlight-aside--note"><p class="starlight-aside__title" aria-hidden="true"><svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="starlight-aside__icon"><path d="M12 11C11.7348 11 11.4804 11.1054 11.2929 11.2929C11.1054 11.4804 11 11.7348 11 12V16C11 16.2652 11.1054 16.5196 11.2929 16.7071C11.4804 16.8946 11.7348 17 12 17C12.2652 17 12.5196 16.8946 12.7071 16.7071C12.8946 16.5196 13 16.2652 13 16V12C13 11.7348 12.8946 11.4804 12.7071 11.2929C12.5196 11.1054 12.2652 11 12 11ZM12.38 7.08C12.1365 6.97998 11.8635 6.97998 11.62 7.08C11.4973 7.12759 11.3851 7.19896 11.29 7.29C11.2017 7.3872 11.1306 7.49882 11.08 7.62C11.024 7.73868 10.9966 7.86882 11 8C10.9992 8.13161 11.0245 8.26207 11.0742 8.38391C11.124 8.50574 11.1973 8.61656 11.29 8.71C11.3872 8.79833 11.4988 8.86936 11.62 8.92C11.7715 8.98224 11.936 9.00632 12.099 8.99011C12.2619 8.97391 12.4184 8.91792 12.5547 8.82707C12.691 8.73622 12.8029 8.61328 12.8805 8.46907C12.9582 8.32486 12.9992 8.16378 13 8C12.9963 7.73523 12.8927 7.48163 12.71 7.29C12.6149 7.19896 12.5028 7.12759 12.38 7.08ZM12 2C10.0222 2 8.08879 2.58649 6.4443 3.6853C4.79981 4.78412 3.51809 6.3459 2.76121 8.17317C2.00433 10.0004 1.8063 12.0111 2.19215 13.9509C2.578 15.8907 3.53041 17.6725 4.92894 19.0711C6.32746 20.4696 8.10929 21.422 10.0491 21.8079C11.9889 22.1937 13.9996 21.9957 15.8268 21.2388C17.6541 20.4819 19.2159 19.2002 20.3147 17.5557C21.4135 15.9112 22 13.9778 22 12C22 10.6868 21.7413 9.38642 21.2388 8.17317C20.7363 6.95991 19.9997 5.85752 19.0711 4.92893C18.1425 4.00035 17.0401 3.26375 15.8268 2.7612C14.6136 2.25866 13.3132 2 12 2ZM12 20C10.4178 20 8.87104 19.5308 7.55544 18.6518C6.23985 17.7727 5.21447 16.5233 4.60897 15.0615C4.00347 13.5997 3.84504 11.9911 4.15372 10.4393C4.4624 8.88743 5.22433 7.46197 6.34315 6.34315C7.46197 5.22433 8.88743 4.4624 10.4393 4.15372C11.9911 3.84504 13.5997 4.00346 15.0615 4.60896C16.5233 5.21447 17.7727 6.23984 18.6518 7.55544C19.5308 8.87103 20 10.4177 20 12C20 14.1217 19.1572 16.1566 17.6569 17.6569C16.1566 19.1571 14.1217 20 12 20Z"></path></svg>Using an insecure hostname</p><section class="starlight-aside__content"><p>If you used an insecure hostname above, configure your local workstation to redirect traffic
to the external IP of the ingress.</p><p>Find the public hostname address of the ingress under <code dir="auto">EXTERNAL-IP</code>.</p><div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">kubectl get service </span><span style="--0:#7FDBCA;--1:#097174">--</span><span style="--0:#C792EA;--1:#8D46B4">namespace</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#FFCB8B;--1:#111111">ingress</span><span style="--0:#D6DEEB;--1:#403F53">-</span><span style="--0:#FFCB8B;--1:#111111">nginx</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#FFCB8B;--1:#111111">ingress</span><span style="--0:#D6DEEB;--1:#403F53">-</span><span style="--0:#FFCB8B;--1:#111111">nginx</span><span style="--0:#D6DEEB;--1:#403F53">-</span><span style="--0:#FFCB8B;--1:#111111">controller</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="kubectl get service --namespace ingress-nginx ingress-nginx-controller"><div></div></button></div></figure></div><div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">NAME</span><span style="--0:#D6DEEB;--1:#403F53">                       </span><span style="--0:#82AAFF;--1:#3C63B3">TYPE</span><span style="--0:#D6DEEB;--1:#403F53">           </span><span style="--0:#82AAFF;--1:#3C63B3">CLUSTER</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#82AAFF;--1:#3C63B3">IP</span><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#82AAFF;--1:#3C63B3">EXTERNAL</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#82AAFF;--1:#3C63B3">IP</span><span style="--0:#D6DEEB;--1:#403F53">                                                                     </span><span style="--0:#82AAFF;--1:#3C63B3">PORT</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#82AAFF;--1:#3C63B3">S</span><span style="--0:#D6DEEB;--1:#403F53">)                      </span><span style="--0:#82AAFF;--1:#3C63B3">AGE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">ingress</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">nginx</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">controller   LoadBalancer   </span><span style="--0:#F78C6C;--1:#AA0982">10.100</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#F78C6C;--1:#AA0982">24.243</span><span style="--0:#D6DEEB;--1:#403F53">   a091398910dbf4ad8aeb2f3f0e864311</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">916cbf853e32c1d5</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">elb</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">us</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">east</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">2</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">amazonaws</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">com</span><span style="--0:#D6DEEB;--1:#403F53">   </span><span style="--0:#F78C6C;--1:#AA0982">80</span><span style="--0:#D6DEEB;--1:#403F53">:</span><span style="--0:#F78C6C;--1:#AA0982">31369</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#82AAFF;--1:#3C63B3">TCP</span><span style="--0:#D6DEEB;--1:#403F53">,</span><span style="--0:#F78C6C;--1:#AA0982">443</span><span style="--0:#D6DEEB;--1:#403F53">:</span><span style="--0:#F78C6C;--1:#AA0982">30370</span><span style="--0:#C792EA;--1:#8D46B4">/</span><span style="--0:#82AAFF;--1:#3C63B3">TCP</span><span style="--0:#D6DEEB;--1:#403F53">   20h</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="NAME                       TYPE           CLUSTER-IP      EXTERNAL-IP                                                                     PORT(S)                      AGEingress-nginx-controller   LoadBalancer   10.100.24.243   a091398910dbf4ad8aeb2f3f0e864311-916cbf853e32c1d5.elb.us-east-2.amazonaws.com   80:31369/TCP,443:30370/TCP   20h"><div></div></button></div></figure></div><p>Find the public IP address of the of the public hostname.</p><div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">nslookup a091398910dbf4ad8aeb2f3f0e864311</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">916cbf853e32c1d5</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">elb</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">us</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">east</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">2</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">amazonaws</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">com</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">Server:         </span><span style="--0:#F78C6C;--1:#AA0982">10.255</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#F78C6C;--1:#AA0982">255.254</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">Address:        </span><span style="--0:#F78C6C;--1:#AA0982">10.255</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#F78C6C;--1:#AA0982">255.254</span><span style="--0:#D6DEEB;--1:#403F53">#</span><span style="--0:#F78C6C;--1:#AA0982">53</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">Non</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">authoritative answer:</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">Name:   a091398910dbf4ad8aeb2f3f0e864311</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">916cbf853e32c1d5</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">elb</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">us</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">east</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">2</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">amazonaws</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">com</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">Address: </span><span style="--0:#F78C6C;--1:#AA0982">13.58</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#F78C6C;--1:#AA0982">11.46</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">Name:   a091398910dbf4ad8aeb2f3f0e864311</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">916cbf853e32c1d5</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">elb</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">us</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">east</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">2</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">amazonaws</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">com</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">Address: </span><span style="--0:#F78C6C;--1:#AA0982">3.19</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#F78C6C;--1:#AA0982">41.78</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="nslookup a091398910dbf4ad8aeb2f3f0e864311-916cbf853e32c1d5.elb.us-east-2.amazonaws.comServer:         10.255.255.254Address:        10.255.255.254#53Non-authoritative answer:Name:   a091398910dbf4ad8aeb2f3f0e864311-916cbf853e32c1d5.elb.us-east-2.amazonaws.comAddress: 13.58.11.46Name:   a091398910dbf4ad8aeb2f3f0e864311-916cbf853e32c1d5.elb.us-east-2.amazonaws.comAddress: 3.19.41.78"><div></div></button></div></figure></div><p>Notice that there are 2 public IP addresses associated with the hostname. This is because that
hostname is on a load balancer. For our purposes, you only need one of those IP addresses. We
will use <code dir="auto">13.58.11.46</code> here.</p><p>Open your <code dir="auto">hosts</code> file on your workstation where you will be using the browser to connect.
For Windows that is under <code dir="auto">C:\Windows\System32\drivers\etc\hosts</code>. For Linux that is under
<code dir="auto">/etc/hosts</code>.</p><p>Add a line that redirects network traffic from the insecure hostname to the public IP address and save the file.</p><div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#F78C6C;--1:#AA0982">13.58</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#F78C6C;--1:#AA0982">11.46</span><span style="--0:#D6DEEB;--1:#403F53">   cp</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">console</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">openshift</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">marketplace</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">apps</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">gi</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">guardium</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">insights</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">com</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="13.58.11.46   cp-console-openshift-marketplace.apps.gi.guardium-insights.com"><div></div></button></div></figure></div><p>After installing Guardium Insights (next step), another ingress will be created that will need to be added to the local hosts file.
Add that additional line now, even though that hostname will not redirect properly until after Guardium Insights is installed.</p><div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="tsx"><code><div class="ec-line"><div class="code"><span style="--0:#F78C6C;--1:#AA0982">13.58</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#F78C6C;--1:#AA0982">11.46</span><span style="--0:#D6DEEB;--1:#403F53">   guardium</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">apps</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">gi</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">guardium</span><span style="--0:#C792EA;--1:#8D46B4">-</span><span style="--0:#D6DEEB;--1:#403F53">insights</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">com</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="13.58.11.46   guardium.apps.gi.guardium-insights.com"><div></div></button></div></figure></div></section></aside>
<h3 id="verify-ingress">Verify Ingress</h3>
<p>Verify that the common webui is now up and available by going to the link above (this will reflect whatever you set for your domain). In our case it is <code dir="auto">cp-console-openshift-marketplace.apps.gi.thinkforward.work</code></p>
<aside aria-label="Using an insecure hostname" class="starlight-aside starlight-aside--note"><p class="starlight-aside__title" aria-hidden="true"><svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="starlight-aside__icon"><path d="M12 11C11.7348 11 11.4804 11.1054 11.2929 11.2929C11.1054 11.4804 11 11.7348 11 12V16C11 16.2652 11.1054 16.5196 11.2929 16.7071C11.4804 16.8946 11.7348 17 12 17C12.2652 17 12.5196 16.8946 12.7071 16.7071C12.8946 16.5196 13 16.2652 13 16V12C13 11.7348 12.8946 11.4804 12.7071 11.2929C12.5196 11.1054 12.2652 11 12 11ZM12.38 7.08C12.1365 6.97998 11.8635 6.97998 11.62 7.08C11.4973 7.12759 11.3851 7.19896 11.29 7.29C11.2017 7.3872 11.1306 7.49882 11.08 7.62C11.024 7.73868 10.9966 7.86882 11 8C10.9992 8.13161 11.0245 8.26207 11.0742 8.38391C11.124 8.50574 11.1973 8.61656 11.29 8.71C11.3872 8.79833 11.4988 8.86936 11.62 8.92C11.7715 8.98224 11.936 9.00632 12.099 8.99011C12.2619 8.97391 12.4184 8.91792 12.5547 8.82707C12.691 8.73622 12.8029 8.61328 12.8805 8.46907C12.9582 8.32486 12.9992 8.16378 13 8C12.9963 7.73523 12.8927 7.48163 12.71 7.29C12.6149 7.19896 12.5028 7.12759 12.38 7.08ZM12 2C10.0222 2 8.08879 2.58649 6.4443 3.6853C4.79981 4.78412 3.51809 6.3459 2.76121 8.17317C2.00433 10.0004 1.8063 12.0111 2.19215 13.9509C2.578 15.8907 3.53041 17.6725 4.92894 19.0711C6.32746 20.4696 8.10929 21.422 10.0491 21.8079C11.9889 22.1937 13.9996 21.9957 15.8268 21.2388C17.6541 20.4819 19.2159 19.2002 20.3147 17.5557C21.4135 15.9112 22 13.9778 22 12C22 10.6868 21.7413 9.38642 21.2388 8.17317C20.7363 6.95991 19.9997 5.85752 19.0711 4.92893C18.1425 4.00035 17.0401 3.26375 15.8268 2.7612C14.6136 2.25866 13.3132 2 12 2ZM12 20C10.4178 20 8.87104 19.5308 7.55544 18.6518C6.23985 17.7727 5.21447 16.5233 4.60897 15.0615C4.00347 13.5997 3.84504 11.9911 4.15372 10.4393C4.4624 8.88743 5.22433 7.46197 6.34315 6.34315C7.46197 5.22433 8.88743 4.4624 10.4393 4.15372C11.9911 3.84504 13.5997 4.00346 15.0615 4.60896C16.5233 5.21447 17.7727 6.23984 18.6518 7.55544C19.5308 8.87103 20 10.4177 20 12C20 14.1217 19.1572 16.1566 17.6569 17.6569C16.1566 19.1571 14.1217 20 12 20Z"></path></svg>Using an insecure hostname</p><section class="starlight-aside__content"><p>If you used an insecure hostname above, use <code dir="auto">cp-console-openshift-marketplace.apps.gi.guardium-insights.com</code>
to verify.</p></section></aside>
<p><img src="/engineering-journal-quantum-safe/css/webui01.Axu99mVM_1DCRh6.webp" alt="Webui" width="1151" height="803" loading="lazy" decoding="async"></p> </div> <footer class="sl-flex astro-3yyafb3n"> <div class="meta sl-flex astro-3yyafb3n">   </div> <div class="pagination-links astro-u2l5gyhi" dir="ltr"> <a href="/engineering-journal-quantum-safe/guardium_insights/01_pre-reqs/" rel="prev" class="astro-u2l5gyhi"> <svg aria-hidden="true" class="astro-u2l5gyhi astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.5rem;"><path d="M17 11H9.41l3.3-3.29a1.004 1.004 0 1 0-1.42-1.42l-5 5a1 1 0 0 0-.21.33 1 1 0 0 0 0 .76 1 1 0 0 0 .21.33l5 5a1.002 1.002 0 0 0 1.639-.325 1 1 0 0 0-.219-1.095L9.41 13H17a1 1 0 0 0 0-2Z"/></svg>  <span class="astro-u2l5gyhi"> Previous <br class="astro-u2l5gyhi"> <span class="link-title astro-u2l5gyhi">Pre-Requisites</span> </span> </a> <a href="/engineering-journal-quantum-safe/guardium_insights/03_gi-install/" rel="next" class="astro-u2l5gyhi"> <svg aria-hidden="true" class="astro-u2l5gyhi astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.5rem;"><path d="M17.92 11.62a1.001 1.001 0 0 0-.21-.33l-5-5a1.003 1.003 0 1 0-1.42 1.42l3.3 3.29H7a1 1 0 0 0 0 2h7.59l-3.3 3.29a1.002 1.002 0 0 0 .325 1.639 1 1 0 0 0 1.095-.219l5-5a1 1 0 0 0 .21-.33 1 1 0 0 0 0-.76Z"/></svg>  <span class="astro-u2l5gyhi"> Next <br class="astro-u2l5gyhi"> <span class="link-title astro-u2l5gyhi">Guardium Insights Installation</span> </span> </a> </div>   </footer>  </div> </div>   </main> </div> </div>  </div> </div>  </body></html>